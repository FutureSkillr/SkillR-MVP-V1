<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Future SkillR — Interactive Roadmap</title>
<style>
:root {
  --bg: #0c0e14;
  --card: #14171f;
  --card-hover: #1a1e28;
  --border: #252835;
  --text: #e4e4e7;
  --muted: #7c7e8a;
  --accent: #6366f1;
  --accent-hover: #818cf8;
  --green: #22c55e;
  --green-bg: rgba(34,197,94,0.1);
  --yellow: #eab308;
  --yellow-bg: rgba(234,179,8,0.1);
  --blue: #3b82f6;
  --blue-bg: rgba(59,130,246,0.1);
  --purple: #a855f7;
  --purple-bg: rgba(168,85,247,0.1);
  --red: #ef4444;
  --orange: #f97316;
  --orange-bg: rgba(249,115,22,0.1);
  --cyan: #06b6d4;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
}

/* Header */
.hero {
  padding: 3rem 2rem 2rem;
  text-align: center;
  border-bottom: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(99,102,241,0.06) 0%, transparent 100%);
}
.hero h1 {
  font-size: 2.2rem;
  font-weight: 800;
  background: linear-gradient(135deg, #6366f1 0%, #a855f7 50%, #ec4899 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 0.3rem;
}
.hero .sub { color: var(--muted); font-size: 0.9rem; }
.hero .date { color: var(--muted); font-size: 0.8rem; margin-top: 0.5rem; opacity: 0.7; }
.entity-row {
  display: flex;
  justify-content: center;
  gap: 0.75rem;
  margin-top: 1.25rem;
  flex-wrap: wrap;
}
.entity-badge {
  padding: 0.3rem 0.7rem;
  border-radius: 6px;
  font-size: 0.72rem;
  font-weight: 600;
  letter-spacing: 0.03em;
}
.eb-skillr { background: var(--blue-bg); color: var(--blue); border: 1px solid rgba(59,130,246,0.2); }
.eb-academy { background: var(--purple-bg); color: var(--purple); border: 1px solid rgba(168,85,247,0.2); }
.eb-engine { background: var(--orange-bg); color: var(--orange); border: 1px solid rgba(249,115,22,0.2); }

/* Container */
.container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }

/* Stats row */
.stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
  gap: 0.75rem;
  padding: 1.5rem 0;
}
.stat {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1rem;
  text-align: center;
}
.stat .n { font-size: 1.8rem; font-weight: 800; line-height: 1; }
.stat .l { font-size: 0.7rem; color: var(--muted); text-transform: uppercase; letter-spacing: 0.07em; margin-top: 0.25rem; }
.stat.g .n { color: var(--green); }
.stat.b .n { color: var(--blue); }
.stat.m .n { color: var(--muted); }

/* Filter bar */
.filters {
  display: flex;
  gap: 0.5rem;
  padding: 0.75rem 0 1.25rem;
  flex-wrap: wrap;
  align-items: center;
}
.filters label { font-size: 0.8rem; color: var(--muted); margin-right: 0.25rem; }
.filter-btn {
  padding: 0.3rem 0.65rem;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--muted);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s;
}
.filter-btn:hover { border-color: var(--accent); color: var(--text); }
.filter-btn.active { background: var(--accent); border-color: var(--accent); color: #fff; }
.search-box {
  margin-left: auto;
  padding: 0.35rem 0.7rem;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: var(--card);
  color: var(--text);
  font-size: 0.8rem;
  width: 200px;
  outline: none;
}
.search-box:focus { border-color: var(--accent); }
.search-box::placeholder { color: var(--muted); }

/* Phase cards */
.phase {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  margin-bottom: 1.25rem;
  overflow: hidden;
}
.phase-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.25rem;
  cursor: pointer;
  user-select: none;
  transition: background 0.15s;
  flex-wrap: wrap;
  gap: 0.5rem;
}
.phase-head:hover { background: var(--card-hover); }
.phase-left {
  display: flex;
  align-items: center;
  gap: 0.65rem;
}
.phase-left h2 { font-size: 1.1rem; font-weight: 700; }
.codename { color: var(--muted); font-weight: 400; font-style: italic; font-size: 0.9rem; }
.phase-right { display: flex; align-items: center; gap: 0.75rem; }
.badge {
  padding: 0.22rem 0.6rem;
  border-radius: 20px;
  font-size: 0.7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
.badge-complete { background: var(--green-bg); color: var(--green); border: 1px solid rgba(34,197,94,0.25); }
.badge-next { background: var(--blue-bg); color: var(--blue); border: 1px solid rgba(59,130,246,0.25); }
.badge-planned { background: var(--yellow-bg); color: var(--yellow); border: 1px solid rgba(234,179,8,0.25); }
.badge-future { background: rgba(124,126,138,0.1); color: var(--muted); border: 1px solid rgba(124,126,138,0.2); }
.chevron {
  transition: transform 0.2s;
  color: var(--muted);
  font-size: 0.9rem;
}
.phase.open .chevron { transform: rotate(90deg); }
.phase-body {
  display: none;
  padding: 0 1.25rem 1.25rem;
}
.phase.open .phase-body { display: block; }
.phase-goal {
  color: var(--muted);
  font-size: 0.85rem;
  margin-bottom: 1rem;
  padding-left: 0.75rem;
  border-left: 3px solid var(--border);
}

/* Progress bar */
.prog-wrap { margin-bottom: 1rem; }
.prog-info { display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--muted); margin-bottom: 0.3rem; }
.prog-bar { height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
.prog-fill { height: 100%; border-radius: 3px; }
.prog-fill.green { background: linear-gradient(90deg, #22c55e, #4ade80); }
.prog-fill.blue { background: linear-gradient(90deg, #3b82f6, #60a5fa); }

/* FR grid */
.fr-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 0.6rem;
}
.fr-card {
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 0.7rem 0.85rem;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
}
.fr-card:hover {
  border-color: var(--accent);
  background: rgba(99,102,241,0.04);
  transform: translateY(-1px);
}
.fr-card-top {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.fr-id {
  font-family: 'SF Mono', Consolas, monospace;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--accent);
  flex-shrink: 0;
}
.fr-title {
  font-size: 0.82rem;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.fr-card-bottom {
  display: flex;
  gap: 0.4rem;
  align-items: center;
}
.fr-tag {
  font-size: 0.65rem;
  padding: 0.1rem 0.4rem;
  border-radius: 3px;
  font-weight: 600;
}
.fr-tag.done { background: var(--green-bg); color: var(--green); }
.fr-tag.in-progress { background: var(--blue-bg); color: var(--blue); }
.fr-tag.draft { background: rgba(124,126,138,0.1); color: var(--muted); }
.fr-tag.specified { background: var(--yellow-bg); color: var(--yellow); }
.fr-tag.open { background: var(--orange-bg); color: var(--orange); }
.fr-tag.absorbed { background: var(--yellow-bg); color: var(--yellow); }
.fr-tag.adapted { background: var(--orange-bg); color: var(--orange); }
.fr-tag.must { color: var(--red); }
.fr-tag.should { color: var(--yellow); }
.fr-tag.could { color: var(--muted); }
.fr-tag.entity {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--muted);
  font-weight: 400;
  max-width: 120px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Exit criteria */
.exit-block { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border); }
.exit-block h4 { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--muted); margin-bottom: 0.4rem; }
.exit-list { list-style: none; }
.exit-list li { font-size: 0.8rem; padding: 0.15rem 0; display: flex; gap: 0.4rem; align-items: flex-start; }
.exit-list li.done::before { content: "\2713"; color: var(--green); font-weight: 700; width: 1em; flex-shrink: 0; }
.exit-list li.pending::before { content: "\25CB"; color: var(--muted); width: 1em; flex-shrink: 0; }
.exit-list li.partial::before { content: "\25D0"; color: var(--yellow); width: 1em; flex-shrink: 0; }

/* Modal */
.modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(4px);
  z-index: 1000;
  justify-content: center;
  align-items: flex-start;
  padding: 3rem 1rem;
  overflow-y: auto;
}
.modal-overlay.visible { display: flex; }
.modal {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  width: 100%;
  max-width: 640px;
  overflow: hidden;
  animation: modalIn 0.2s ease;
}
@keyframes modalIn {
  from { opacity: 0; transform: translateY(-20px) scale(0.97); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
.modal-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  padding: 1.25rem 1.5rem;
  border-bottom: 1px solid var(--border);
  gap: 1rem;
}
.modal-header-left { flex: 1; }
.modal-header .fr-id-big {
  font-family: 'SF Mono', Consolas, monospace;
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--accent);
  margin-bottom: 0.2rem;
}
.modal-header h3 { font-size: 1.15rem; font-weight: 700; line-height: 1.3; }
.modal-close {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 1.4rem;
  cursor: pointer;
  padding: 0.2rem;
  line-height: 1;
  transition: color 0.15s;
}
.modal-close:hover { color: var(--text); }
.modal-meta {
  display: flex;
  gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  border-bottom: 1px solid var(--border);
  flex-wrap: wrap;
}
.modal-meta .fr-tag { font-size: 0.72rem; }
.modal-body { padding: 1.25rem 1.5rem; }
.modal-section { margin-bottom: 1rem; }
.modal-section:last-child { margin-bottom: 0; }
.modal-section h4 {
  font-size: 0.72rem;
  text-transform: uppercase;
  letter-spacing: 0.07em;
  color: var(--muted);
  margin-bottom: 0.4rem;
  font-weight: 600;
}
.modal-section p {
  font-size: 0.85rem;
  color: var(--text);
  line-height: 1.6;
  white-space: pre-wrap;
}
.modal-section ul {
  list-style: none;
  padding: 0;
}
.modal-section ul li {
  font-size: 0.82rem;
  padding: 0.2rem 0;
  padding-left: 1.2rem;
  position: relative;
}
.modal-section ul li::before {
  content: "\25CB";
  position: absolute;
  left: 0;
  color: var(--muted);
  font-size: 0.7rem;
}
.modal-section .deps {
  font-size: 0.82rem;
  color: var(--muted);
  white-space: pre-wrap;
}

/* Footer */
.footer {
  text-align: center;
  padding: 2rem 0 1.5rem;
  border-top: 1px solid var(--border);
  margin-top: 2rem;
  color: var(--muted);
  font-size: 0.75rem;
}
.footer a { color: var(--accent); text-decoration: none; }
.footer a:hover { text-decoration: underline; }

/* Responsive */
@media (max-width: 640px) {
  .hero { padding: 2rem 1rem 1.5rem; }
  .hero h1 { font-size: 1.5rem; }
  .fr-grid { grid-template-columns: 1fr; }
  .stats { grid-template-columns: repeat(3, 1fr); }
  .modal { margin: 0; border-radius: 14px 14px 0 0; align-self: flex-end; max-height: 85vh; overflow-y: auto; }
}
</style>
</head>
<body>

<div class="hero">
  <h1>Future SkillR — Interactive Roadmap</h1>
  <div class="sub">Click any feature request to see details</div>
  <div class="date">Generated: 2026-02-23 | Source: docs/ROADMAP.md + 119 FR files</div>
  <div class="entity-row">
    <span class="entity-badge eb-skillr">SkillR — Kids Education Brand &amp; Sub-Branding Provider</span>
    <span class="entity-badge eb-academy">maindset.ACADEMY — New Learning Education Brand</span>
    <span class="entity-badge eb-engine">maindfull.LEARNING — New Learning AI Engine (by maindset.ACADEMY)</span>
  </div>
</div>

<div class="container">

<div class="stats">
  <div class="stat g"><div class="n" id="stat-done">0</div><div class="l">FRs Done</div></div>
  <div class="stat b"><div class="n" id="stat-progress">0</div><div class="l">In Progress</div></div>
  <div class="stat m"><div class="n" id="stat-draft">0</div><div class="l">Draft / Planned</div></div>
  <div class="stat g"><div class="n" id="stat-specified">0</div><div class="l">Specified</div></div>
  <div class="stat b"><div class="n" id="stat-total">0</div><div class="l">Total FRs</div></div>
</div>

<div class="filters">
  <label>Filter:</label>
  <button class="filter-btn active" data-filter="all">All</button>
  <button class="filter-btn" data-filter="done">Done</button>
  <button class="filter-btn" data-filter="in-progress">In Progress</button>
  <button class="filter-btn" data-filter="draft">Draft</button>
  <button class="filter-btn" data-filter="specified">Specified</button>
  <button class="filter-btn" data-filter="must">Must</button>
  <input class="search-box" type="text" placeholder="Search FR..." id="search">
</div>

<!-- Phases rendered by JS -->
<div id="phases"></div>

</div>

<!-- Modal -->
<div class="modal-overlay" id="modal-overlay">
  <div class="modal" id="modal">
    <div class="modal-header">
      <div class="modal-header-left">
        <div class="fr-id-big" id="modal-id"></div>
        <h3 id="modal-title"></h3>
      </div>
      <button class="modal-close" id="modal-close">&times;</button>
    </div>
    <div class="modal-meta" id="modal-meta"></div>
    <div class="modal-body" id="modal-body"></div>
  </div>
</div>

<div class="footer">
  <p><strong>Future SkillR</strong> &nbsp;|&nbsp; <a href="https://github.com/FutureSkillr/MVP72">GitHub</a> &nbsp;|&nbsp; <a href="https://future-skillr-1041496140898.us-west1.run.app/">Live Demo</a></p>
  <p>SkillR &bull; maindset.ACADEMY &bull; maindfull.LEARNING</p>
</div>

<script>
const FR_DATA = [{"id":"DFR-001","title":"App Icon Integration","status":"done","priority":"must","problem":"The SkillR brand team delivered a complete logo/icon set in `frontend/graphx-design/SKILLR Logo Set/` but none of these assets are used in the app. The current app uses a generic blue-gradient \"S\" letter SVG as app icon, an old `frontend/images/favicon.ico` PNG file, and no app icon/logo graphic on the Login/OAuth screen.","solution":"Integrate the official SkillR App Icon into all icon/favicon touchpoints and the OAuth Login screen:\n- Replace generic SVG icons with official SkillR PNG icons from the brand set\n- Update favicon to official SkillR favicon\n- Update PWA manifest to use official icons\n- Add App Icon visual to the Login page","criteria":["Official SkillR favicon shown in browser tab","PWA manifest references official PNG icons (192x192, 512x512)","Apple touch icon uses official asset","Login/OAuth screen displays the App Icon above the heading","Old generic SVG icons removed","Old favicon.ico from `frontend/images/` removed"],"deps":"- Brand assets in `frontend/graphx-design/SKILLR Logo Set/`\n- DFR-002 (brand name consistency — title tag update)","notes":"Assets copied to `frontend/public/icons/` and `frontend/public/favicon.ico` for serving."},{"id":"DFR-002","title":"Brand Name Consistency — \"Future SkillR\"","status":"done","priority":"must","problem":"The codebase uses \"Future Skiller\" (lowercase 'r') inconsistently. The correct brand name is \"Future SkillR\" (capital R). This appears in frontend components, HTML landing pages, backend log messages, config files, and documentation.","solution":"Rename all occurrences of \"Future Skiller\" to \"Future SkillR\" across:\n- Frontend source files (TSX/TS components, AI prompts)\n- HTML files (index.html, landing pages, ops deployment pages)\n- Backend source (Go log messages)\n- Config files (Makefile, .env.example)\n- Documentation (README.md, all concept/feature/arch docs)","criteria":["`grep -r \"Future Skiller\" frontend/` returns 0 results","`grep -r \"Future Skiller\" backend/` returns 0 results","`grep -r \"Future Skiller\" docs/` returns 0 results","`grep -r \"Future Skiller\" concepts/` returns 0 results","Page title reads \"Future SkillR - Bist Du ein SkillR?\"","PWA manifest name is \"Future SkillR\""],"deps":"- DFR-001 (icon integration — title tag shared update)","notes":"Infrastructure slugs like `future-skillr` (hyphenated lowercase) are already correct and not in scope for this change."},{"id":"DFR-003","title":"Use Official App Icon in Navigation and Footer","status":"done","priority":"must","problem":"The WelcomePage nav bar and footer display a gradient-colored \"S\" letter as a placeholder logo. The Layout header (used for logged-in views) shows only text \"SkillR\" with no icon. The official SkillR App Icon (`/icons/app-icon.png`) is available but only used for favicon/PWA (DFR-001), not for in-app branding.","solution":"Replace all \"S\" text placeholder logos with the official SkillR App Icon image:\n- WelcomePage: nav bar logo (top-left)\n- WelcomePage: footer logo (bottom-left)\n- Layout: header logo (top-left, logged-in views)\n\nMerch product mockups (mug \"S\", cap \"SR\", hoodie \"S\") are decorative illustrations and remain unchanged.","criteria":["WelcomePage nav bar shows `<img src=\"/icons/app-icon.png\">` instead of gradient \"S\" div","WelcomePage footer shows `<img src=\"/icons/app-icon.png\">` instead of gradient \"S\" div","Layout header shows app icon before \"SkillR\" text","Icon renders correctly at 40px (nav), 32px (footer), and 28px (layout header)","Alt text set to \"SkillR\" for accessibility"],"deps":"- DFR-001 (app icon assets already in `frontend/public/icons/`)","notes":"The app icon is a rounded square with the SkillR \"S\" mark on white background. It renders well at small sizes due to its simple, high-contrast design."},{"id":"DFR-004","title":"Coach Select Panel Visual Polish","status":"done","priority":"must","problem":"The Coach Select Panel (`CoachSelectPage.tsx`) has four visual issues:\n\n1. **Unequal card sizes** — cards in the grid vary in height depending on content length (tagline, setting text). This looks uneven, especially on wider screens where all 6 coaches appear side-by-side.\n2. **No card deck border** — the coach grid floats without visual containment. A subtle border around the deck would give it a","solution":"### 1. Equal-height cards\nAdd `h-full` to the `CoachCard` button element so all cards stretch to the same height within their grid cell. The grid already uses equal-width columns; this ensures equal height.\n\n**File:** `frontend/components/intro/CoachCard.tsx`\n- Add `h-full flex flex-col` to the outer `<button>` className\n- Move the \"Waehlen\" CTA to the bottom with `mt-auto`\n\n### 2. Card deck borde","criteria":["All 6 coach cards render at exactly the same height within each grid row","The card deck has a thin visible border (`border-slate-700/50`) and `rounded-2xl` corners","Coach avatars show photographic images, not cartoon SVG illustrations","SVG avatars remain as fallback when no `photoUrl` is configured","Heading reads \"Wähle Deinen Coach\" with proper umlaut and capitalization","Cards remain responsive: 2 columns on mobile, 3 columns on desktop","No regression in waiting-room mode (queue active → cards greyed out)"],"deps":"- 6 coach photo assets must be provided/sourced before implementation","notes":"- The inline SVG faces in `CoachAvatar.tsx` are ~200 lines of hand-drawn SVG per coach. They should be kept as fallback but photo mode should be the default when assets are available.\n- The `Waehlen` button text inside `CoachCard.tsx` (line 40) should also be updated to `Wählen` for umlaut consisten"},{"id":"DFR-005","title":"Landing Page App Icon & Reusable Legal Footer","status":"done","priority":"must","problem":"The WelcomePage links to stakeholder-specific landing pages at `/landing/{kids,parents,companies,...}.html`. These landing pages currently:\n\n1. **Missing App Icon** — do not display the official SkillR App Icon (`/icons/app-icon.png`) that the main WelcomePage shows (see DFR-001, DFR-003).\n2. **Missing legal footer** — do not include the Impressum, Datenschutz, and Cookie-Einstellungen links that ","solution":"### 1. Reusable footer HTML partial\n\nCreate a static HTML partial that can be included in any page — React-rendered or static HTML landing pages.\n\n**File:** `frontend/public/includes/legal-footer.html` — Create\n- Contains the same Impressum / Datenschutz / Cookie-Einstellungen links\n- Styled with inline CSS or shared utility classes so it works standalone\n- Includes the SkillR App Icon and copyrig","criteria":["A reusable legal footer partial exists at `frontend/public/includes/legal-footer.html`","All landing pages display the official SkillR App Icon in the header","All landing pages include the legal footer with Impressum, Datenschutz, and Cookie-Einstellungen links","The `Layout` component footer shows `LegalFooter` instead of the placeholder text","Footer links open the correct pages (Impressum, Datenschutz) or trigger the Cookie modal","Footer renders correctly on mobile (min 44px touch targets, safe-area insets)","TMG §5 compliance: Impressum reachable from every publicly accessible page"],"deps":"- DFR-001 (App Icon assets)\n- DFR-003 (App Icon in navigation)\n- FR-066 (Cookie consent & legal footer)","notes":"- The `LegalFooter` component already supports `variant=\"full\"` and `variant=\"compact\"`. Landing pages should use the full variant; the Layout can use compact.\n- If landing pages are generated/templated (not hand-written HTML), the footer should be injected during the build step.\n- The cookie settin"},{"id":"DFR-006","title":"Header Bar Order Flip — EU Notice on Top","status":"in-progress","priority":"must","problem":"The current WelcomePage header has two fixed bars stacked vertically:\n1. **Bar 1 (top)**: Navigation — SkillR logo + \"Anmelden\" button\n2. **Bar 2 (below)**: EU co-funding notice — EU flag + Kofinanzierung text\n\nEU funding guidelines require the co-funding notice to have maximum visibility. Moving it to the topmost position ensures compliance and gives it the prominence it deserves.","criteria":["EU co-funding bar renders at the very top of the page","Navigation bar (logo + Anmelden) renders directly below the EU bar","EU bar retains its dark background (`bg-slate-900/80 backdrop-blur-sm`)","Nav bar retains its glass effect background","\"Anmelden\" button retains its blue-to-purple gradient","EU flag and text remain centered with current sizing","Hero section content is not overlapped by the header bars","Mobile layout remains functional (no overflow, touch targets >= 44px)"],"deps":"- FR-112: EU Co-Funding Notice (original implementation)\n- DFR-003: Nav Logo App Icon","notes":"- The EU bar height on mobile (flex-col) may differ from desktop (flex-row). The nav bar's `top-[Xpx]` offset may need a responsive value or a CSS variable.\n- This is a visual-only change — no API or data model impact."},{"id":"DFR-007","title":"Dismissable EU Co-Funding Bar with Hover Reveal","status":"done","priority":"should","problem":"The EU co-funding notice bar at the top of the page takes up vertical space permanently. Users who have read it should be able to dismiss it. Additionally, the same EU info is duplicated in the footer, which is redundant when the top bar is visible.","solution":"1. Add a small (x) dismiss button to the EU top bar.\n2. When dismissed, the bar collapses to a thin hover-trigger strip. Hovering over it reveals the bar again temporarily.\n3. When the top EU bar is visible (not dismissed), remove the EU info from the footer to avoid duplication.\n4. The nav bar shifts up to `top-0` when the EU bar is dismissed.","criteria":["EU bar has a visible (x) dismiss button","Clicking (x) collapses the EU bar","Nav bar shifts to top-0 when EU bar is dismissed","Hovering near the top of the page reveals the EU bar again","Footer EU section is hidden when top bar is visible (not dismissed)","Footer EU section appears when top bar is dismissed","EU notice is always accessible from at least one location on the page"],"deps":"- DFR-006: Header bar order flip\n- FR-112: EU Co-Funding Notice"},{"id":"DFR-008","title":"Full-Width Globe Universe & Remove Profile Button","status":"done","priority":"must","problem":"1. The \"Mein Profil ansehen\" button at the bottom of the globe universe view is unnecessary clutter — profile access is available elsewhere.\n2. The globe universe area is constrained to `max-w-5xl` (~1024px) — it should stretch full-width to be more immersive.\n3. The area below the globe (carousel, filter pills) lacks visual separation from the rest of the page.","criteria":["\"Mein Profil ansehen\" button is removed from both GlobeInner and Globe2DFallback","Globe universe stretches full width (no max-w constraint on outer container)","A subtle gradient background is applied to the universe area below the globe","Carousel arrows remain accessible and not cut off at full width","Globe responsive sizing still works correctly","No horizontal scrollbar introduced"],"deps":"- FR-116: Lernreise Content Pack (carousel content)","notes":"- The `onViewProfile` callback remains in the component interface for API compatibility — it's just not rendered as a button anymore.\n- The gradient should be subtle enough to blend with the dark page background."},{"id":"FR-001","title":"Social Login (Google, Apple, Meta)","status":"draft","priority":"must","criteria":["User can sign in with Google OAuth 2.0","User can sign in with Apple Sign In","User can sign in with Meta (Facebook) Login","All three providers produce a unified Firebase Auth identity","Only email and display name are requested from providers (minimal scope)","Age gate appears before first login completes (FR-033)","Apple relay email addresses work correctly","Login works in mobile browsers (Chrome, Safari) — no app store required"],"deps":"- FR-002 (Email login — fallback provider)\n- FR-003 (Firebase user data persistence)\n- FR-033 (Datenschutz for Minors — parental consent flow)"},{"id":"FR-002","title":"Email-Password Login","status":"draft","priority":"should","deps":"- FR-001 (Social login — primary providers)\n- FR-003 (Firebase user data persistence)\n- FR-033 (Datenschutz for Minors — parental consent flow for under-16)"},{"id":"FR-003","title":"Firebase User Data Persistence","status":"draft","priority":"must","deps":"- FR-001 (Google OAuth) or FR-002 (Email login) for authentication context"},{"id":"FR-004","title":"Interest-Based Journey Entry","status":"draft","priority":"must","deps":"- FR-005 (Gemini AI dialogue engine)"},{"id":"FR-005","title":"Gemini AI Dialogue Engine","status":"draft","priority":"must","deps":"- FR-003 (Firebase — dialogue history storage)"},{"id":"FR-006","title":"VUCA Navigation and Exploration","status":"draft","priority":"must","deps":"- FR-005 (Gemini AI dialogue engine)\n- FR-004 (Interest entry — initial topic and location)"},{"id":"FR-007","title":"VUCA Bingo Completion Matrix","status":"draft","priority":"must","criteria":["VUCA onboarding chat shows LED progress indicator (dots/bar) matching IntroChat pattern","Progress fills based on user message count toward goal detection","Bingo board appears on VucaDashboard after curriculum generation (existing behavior)"],"deps":"- FR-005 (Gemini AI dialogue engine — dimension tagging)\n- FR-006 (VUCA navigation — journey steps)"},{"id":"FR-008","title":"Skill / Interest Profile Generation","status":"draft","priority":"must","deps":"- FR-003 (Firebase — profile data storage)\n- FR-005 (Gemini — profile extraction from dialogue)\n- FR-007 (VUCA bingo — journey completion triggers final profile)"},{"id":"FR-009","title":"Profile Visualization","status":"in-progress","priority":"must","criteria":["Spider/radar diagram shows all dimensions with scores from station results","Responsive sizing: 3-tier (mobile <400px, tablet, desktop)","Coach selection grid in profile with selected/dimmed states","Dimmed cards colorize on hover, revert when cursor leaves","Coach change triggers `coach_change` analytics event","Dialect is derived from coach (no independent dialect selector)","Profile data syncs to backend via API (FR-111)"],"deps":"- FR-008 (Skill profile generation — data source)\n- FR-054 (Intro sequence — initial coach selection)"},{"id":"FR-010","title":"AI Coach Voice Interaction","status":"in-progress","priority":"should","criteria":["TTS via Gemini voice models with dialect-aware prompts","Dialect determined by selected coach (no independent selector)","Browser speechSynthesis fallback when Gemini TTS fails","Voice toggle button in app header controls audio output globally"],"deps":"- FR-005 (Gemini AI dialogue engine — content generation)\n- FR-009 (Profile visualization — coach selection UI)","notes":"- **Vertex AI model**: TTS uses `gemini-2.5-flash-tts` (not the preview variant). The preview name `gemini-2.5-flash-preview-tts` is a Google AI Studio identifier and does not work with Vertex AI.\n- **Region requirement**: Gemini TTS is not available in all GCP regions. The backend uses `GCP_TTS_REG"},{"id":"FR-011","title":"Text and Voice Mode Switching","status":"draft","priority":"should","deps":"- FR-005 (Gemini AI dialogue engine)\n- FR-010 (AI coach voice)"},{"id":"FR-012","title":"Session Continuity","status":"draft","priority":"must","deps":"- FR-003 (Firebase — state persistence)\n- FR-007 (VUCA bingo matrix — progress tracking)\n- FR-008 (Skill profile — incremental updates)"},{"id":"FR-013","title":"Web App Deployment","status":"draft","priority":"must","deps":"- All other FRs (this is the delivery vehicle)"},{"id":"FR-014","title":"Interest Profile Tracking (Backend)","status":"draft","priority":"must","deps":"- FR-003 (Firebase user data)\n- FR-005 (Gemini AI dialogue engine)\n- TC-004 (Multimodal storage layer)\n- US-001 (Interest profile discovery)"},{"id":"FR-015","title":"GeoQB / OpenStreetMap Service (Backend)","status":"draft","priority":"should","deps":"- TC-001 (GeoQB and OpenStreetMap integration)\n- FR-006 (VUCA navigation)\n- US-002 (Contextual exploration across places)"},{"id":"FR-016","title":"Wikipedia Knowledge Service (Backend)","status":"draft","priority":"should","deps":"- TC-002 (Wikipedia data integration)\n- FR-005 (Gemini AI dialogue engine)\n- US-003 (Job-Navigator)"},{"id":"FR-017","title":"Job Portal Data Service (Backend)","status":"draft","priority":"should","deps":"- TC-003 (Job portal data integration)\n- BC-002 (Job-Navigator)\n- US-003 (Job-Navigator and Moeglichkeitsraum)\n- DC-002 (Gegensatzsuche)"},{"id":"FR-018","title":"Job-Navigator Engine (Backend)","status":"draft","priority":"should","deps":"- FR-014 (Interest profile tracking)\n- FR-016 (Wikipedia knowledge service)\n- FR-017 (Job portal data service)\n- BC-002 (Job-Navigator concept)\n- DC-002 (Gegensatzsuche)\n- DC-003 (Moeglichkeitsraum)"},{"id":"FR-019","title":"Multimodal Storage Layer (Backend)","status":"draft","priority":"must","deps":"- FR-003 (Firebase user data)\n- TC-004 (Multimodal storage layer architecture)\n- US-006 (Multimodal interaction tracking)"},{"id":"FR-020","title":"Level 2 Reflection Engine (Backend)","status":"draft","priority":"should","deps":"- FR-005 (Gemini AI dialogue engine)\n- FR-014 (Interest profile tracking)\n- FR-019 (Multimodal storage layer)\n- TC-005 (Response timing and intent analysis)\n- DC-004 (Level 2 reflection system)\n- US-005 (Level 2 reflection and capability assessment)"},{"id":"FR-021","title":"Chamber Dashboard (Backend + Frontend)","status":"draft","priority":"could","deps":"- FR-017 (Job portal data service — source of apprenticeship data)\n- TC-006 (Matching engine — match statistics)\n- BC-003 (Chamber visibility concept)\n- US-007 (Chamber visibility user story)"},{"id":"FR-022","title":"Company Moeglichkeitsraum Profile (Backend)","status":"draft","priority":"could","deps":"- TC-006 (Matching engine)\n- BC-004 (Company responsibility model)\n- US-008 (Company Moeglichkeitsraum user story)\n- FR-018 (Job-Navigator engine)\n- FR-021 (Chamber Dashboard — novel position analytics)\n- FR-023 (Bedarfserfassung — demand signals for non-catalog roles)"},{"id":"FR-023","title":"Bedarfserfassung der Kammern (Chamber Demand Signal Capture)","status":"draft","priority":"could","problem":"Chambers (IHK, Handwerkskammer) can currently show what apprenticeships exist (FR-021), but they cannot express what they **need**. The matching engine (TC-006) lacks demand signals — it knows what students are interested in but not where the actual gaps and opportunities are from the employer side. Without demand data, matching is one-directional.\n\n\"Wir nehmen die Bedarfe auf\" — capturing demand ","solution":"A demand signal capture system where chamber representatives can:\n- Specify apprenticeship categories with current demand levels (high/medium/low)\n- Tag demand by region (Einzugsbereich der Kammer)\n- Indicate urgency and seasonal patterns (e.g., Ausbildungsstart September)\n- Link demand entries to specific member companies (who must have a Moeglichkeitsraum profile per FR-022)\n\nDemand signals feed","criteria":["Chamber representatives can create and update demand entries per apprenticeship category and region","Demand entries have structured fields: category, region, demand level, urgency, linked companies","The matching engine (TC-006) consumes demand signals as a matching parameter","Demand data is visible to chambers in aggregate on their dashboard (FR-021)","Students never see raw demand data — it influences match ranking transparently","Companies linked to demand entries must have an active Moeglichkeitsraum profile (FR-022)"],"deps":"- FR-021 (Chamber Dashboard — UI surface for demand management)\n- FR-022 (Company Moeglichkeitsraum Profile — companies must participate)\n- TC-006 (Matching Engine — consumes demand signals)\n- BC-003 (Chamber Visibility and Regional Matching — business model)\n- BC-004 (Company Responsibility Model —","notes":"- Demand signals are not visible to students directly — they influence match quality, not match existence\n- This enables the \"Firmen in die Verantwortung nehmen\" principle: companies that don't maintain their Moeglichkeitsraum profile won't appear in demand-linked matches even if the chamber registe"},{"id":"FR-024","title":"AI Reisebegleiter Multi-Agent System","status":"draft","priority":"should","problem":"The current Gemini dialogue engine (FR-005) is a single monolithic interaction layer. The VUCA journey requires different dialogue strategies at different moments: exploration needs curiosity-driven breadth, reflection needs coaching depth, skill verification needs structured evidence gathering, and matching needs consent-mediated facilitation. A single prompt/persona cannot optimally serve all th","solution":"Implement an agent orchestration layer on top of the Gemini dialogue engine that manages four specialized agent personas:\n\n1. **Entdecker-Agent** — Exploration and curiosity. Active during interest discovery and VUCA navigation. Drives Gegensatzsuche. Warm, playful tone.\n2. **Reflexions-Agent** — Level 2 coaching. Triggered by journey milestones or behavioral signals (TC-005). Open-ended probing. ","criteria":["Agent orchestration layer selects the appropriate agent persona based on journey state","Each agent uses a distinct Gemini system prompt with role-specific instructions","Transitions between agents are imperceptible to the student","All agent interactions are stored in the multimodal storage layer with agent type metadata","The Reflexions-Agent activates at appropriate Level 2 moments (DC-004)","The Skill-Agent links interactions to portfolio entries (TC-007)","The Match-Agent never reveals student data without explicit consent","Agent behavior is age-appropriate and adapts to re-entering adults (US-012)"],"deps":"- FR-005 (Gemini AI Dialogue Engine — foundation model)\n- FR-019 (Multimodal Storage Layer — shared context)\n- FR-020 (Level 2 Reflection Engine — triggers Reflexions-Agent)\n- TC-004 (Multimodal Storage Layer — data model)\n- TC-005 (Response Timing and Intent Analysis — behavioral triggers)\n- TC-006","notes":"- All agents share the same Gemini model instance; differentiation is via system prompt and parameters (temperature, top-p)\n- The user-facing term is \"Reisebegleiter\", never \"Agent\" or \"Bot\"\n- Post-MVP: agents could develop persistent personality traits that evolve with the student's journey history"},{"id":"FR-025","title":"Eltern-Dashboard","status":"draft","priority":"could","problem":"Parents are enablers of the youth journey but currently have no visibility into what their child does in the app. Without insight, parents may perceive the app as \"just another screen time distraction\" and withdraw support. The Checkliste.md requires: \"Eltern koennen nachvollziehen, was ihr Kind gemacht hat.\"","solution":"A dedicated parent view that shows aggregated journey progress without exposing private interaction details.\n\n### Parent Dashboard Features\n- **Interest Radar**: Cluster visualization of the child's emerging interest areas (e.g., \"Natur\", \"Technik\", \"Kreatives\") — derived from profile dimensions, not from raw conversations\n- **VUCA Bingo Progress**: How far along is the journey? Which dimensions a","criteria":["Student can generate a parent invite code","Parent can create account and link to child via invite code","Parent dashboard shows interest radar, VUCA progress, milestones, activity summary","Parent cannot access raw dialogue content or portfolio entries","Student can optionally share specific portfolio entries","Student can revoke parent link at any time","Multi-child support for one parent account","GDPR-compliant: parental consent required for under-16 data processing"],"deps":"- FR-001 / FR-002 (Authentication — parent account creation)\n- FR-003 (Firebase User Data — parent data model)\n- FR-008 (Skill/Interest Profile — source for interest radar)\n- FR-007 (VUCA Bingo — source for progress display)\n- FR-027 (Rollenbasierte App-Ansichten — parent view)","notes":"- Priority \"could\" because MVP can launch without parent view — but it's essential for institutional trust (IHK demo, school partnerships)\n- The privacy boundary is a key differentiator: \"Wir geben Eltern Einblick, nicht Kontrolle\"\n- Consider push notifications for milestones (opt-in)"},{"id":"FR-026","title":"Micro-Session UX (5-Minuten-Modus)","status":"draft","priority":"should","problem":"Children and youth primarily use the app in short bursts — \"im Bus sitzen und 5 Minuten was machen\" (transcript). The current dialogue model assumes extended sessions. If the app doesn't support meaningful micro-interactions, users will abandon it because every interaction feels too long to start.","solution":"Design all interactions to be meaningful within 5 minutes or less, with instant resume capability.\n\n### Micro-Session Principles\n1. **Instant Resume**: App opens exactly where the user left off. No \"loading your journey\" — immediate continuation of the last dialogue/station.\n2. **Bite-Sized Interactions**: Each station/exploration step is self-contained and completable in 2-5 minutes.\n3. **Progres","criteria":["App resumes within 2 seconds to the last interaction state","A single exploration step is completable in under 5 minutes","Closing the app mid-interaction loses no data","The next session picks up naturally from where the user left off","Every micro-session contributes to profile and VUCA bingo progress","Quick-start options available for new sessions","Works on mobile browser with typical 4G latency"],"deps":"- FR-012 (Session Continuity — persistence foundation)\n- FR-019 (Multimodal Storage Layer — incremental saves)\n- FR-005 (Gemini Dialogue Engine — fast response times)\n- FR-013 (Web App Deployment — mobile optimization)","notes":"- This is a \"should\" priority because without micro-session support, the target audience (bus-riding teenagers) won't engage regularly\n- The 5-minute constraint also forces good content design — no bloated interactions\n- Consider offline-first for reading last session summary (even without connectiv"},{"id":"FR-027","title":"Rollenbasierte App-Ansichten (Role-Based App Views)","status":"draft","priority":"should","problem":"Future Skiller serves four distinct target groups (students, parents, chambers, companies), each with fundamentally different needs and interactions. A single UI cannot serve all roles. Without role-specific views, the app either overwhelms students with institutional features or underwhelms institutional partners with a youth-focused interface.","solution":"Implement role-based views where each target group sees a dedicated interface tailored to their role in the VUCA-Ökosystem (DC-008).\n\n### View: Entdecker (Student)\n- **Primary interface**: The VUCA journey\n- Features: Dialogue with AI Reisebegleiter, VUCA bingo, profile visualization, Reisetagebuch\n- Tone: Warm, exploratory, gamified, age-appropriate\n- NO institutional elements visible (no dashboa","criteria":["Role selection at signup: \"Ich bin Schueler / Elternteil / Kammer / Unternehmen\"","Each role sees only their dedicated view after login","Student view contains no institutional elements","Parent view cannot access raw interaction data (enforced at API level)","Chamber view shows aggregate analytics and landscape management","Company view shows profile editor and match notifications","All views work on mobile browsers","Role-scoped API authorization prevents cross-role data access"],"deps":"- FR-001, FR-002 (Authentication — role-aware account creation)\n- FR-003 (Firebase — role-specific data model)\n- FR-021 (Chamber Dashboard — Wegweiser view content)\n- FR-022 (Company Profile — Mentor view content)\n- FR-025 (Eltern-Dashboard — Motivator view content)\n- DC-008 (Rollenbasiertes VUCA-Ök","notes":"- MVP can launch with Student view only and add other views incrementally\n- The Student view is the core product; other views are enablers/supporters\n- Consider a \"demo mode\" for each role that shows how matching would work (for IHK presentations)"},{"id":"FR-028","title":"Sponsored Content Integration","status":"draft","priority":"could","problem":"The VUCA journey generates all content dynamically via the LLM (FR-005), which is powerful but lacks real-world authenticity. Meanwhile, companies have deep domain expertise they want to share, and need a non-advertising channel to reach future talent. Without a sponsoring mechanism, companies remain passive listing providers instead of active ecosystem participants.","solution":"A system where companies can contribute educational content that integrates naturally into the VUCA journey, transparently labeled as sponsored.\n\n### Content Types\n1. **Domain Expertise Snippets**: Short factual contributions about the company's industry (e.g., coffee processing, wood technology, logistics). Fed to the LLM as grounding data for relevant journey stations.\n2. **Real-World Challenges","criteria":["Companies can upload domain expertise content through their view","Content is tagged and categorized for contextual matching","The LLM can incorporate sponsored content as grounding data for relevant stations","Sponsored interactions are labeled \"Supported by [Company]\" in the UI","Student can skip sponsored content without losing progress","Engagement with sponsored content generates anonymized signals for matching","Quality review process exists before content goes live","JMStV compliance: content qualifies as educational, not promotional"],"deps":"- FR-005 (Gemini Dialogue Engine — LLM incorporates sponsored grounding data)\n- FR-022 (Company Moeglichkeitsraum Profile — company identity)\n- FR-027 (Rollenbasierte App-Ansichten — Mentor/Sponsor content upload interface)\n- TC-006 (Matching Engine — receives engagement signals)\n- BC-007 (Bildungss","notes":"- Priority \"could\" because MVP can launch without sponsoring — but it's the primary B2B revenue channel post-MVP\n- Start with text-based content; expand to multimedia later\n- Consider a content marketplace where companies compete to provide the best educational content for a domain"},{"id":"FR-029","title":"Multiplikatoren-Onboarding","status":"draft","priority":"could","problem":"Future Skiller reaches youth through multipliers (teachers, Arbeitsamt counselors, chamber representatives, parents). Each multiplier type has different technical comfort levels and different contexts where they introduce the app. Without dedicated onboarding flows and distribution tools, multipliers won't adopt the platform because it's too complex to explain or distribute.","solution":"Role-specific onboarding flows and distribution tools for each multiplier type.\n\n### Distribution Tools\n\n#### QR-Code Cards (Physical)\n- Multiplier generates a personalized QR code through their dashboard\n- QR code links to the app with the multiplier's referral ID embedded\n- Physical cards can be printed (template provided) for events: Tag der Ausbildung, school visits, counseling sessions\n- \"Der","criteria":["QR-code generation available for all multiplier roles","QR codes link to app with referral tracking","Printable card template (PDF) available for download","Class/group code generation for teachers","Referral link generation for digital sharing","Referral tracking dashboard: activations per multiplier","Role-specific onboarding tutorials (2-3 minute walkthroughs)","Works without technical knowledge (\"der 50-jaehrige Berater\")"],"deps":"- FR-001, FR-002 (Authentication — multiplier account creation)\n- FR-021 (Chamber Dashboard — chamber multiplier interface)\n- FR-025 (Eltern-Dashboard — parent multiplier interface)\n- FR-027 (Rollenbasierte App-Ansichten — multiplier views)\n- BC-008 (Multiplikatoren-Netzwerk — strategy)","notes":"- Priority \"could\" because MVP can launch with direct signup — but multiplier-driven acquisition is the primary growth channel\n- The QR-code card is deliberately low-tech: it works in contexts where digital tools don't (school hallway, Arbeitsamt waiting room, Ausbildungsmesse)\n- Track multiplier ef"},{"id":"FR-030","title":"Third-Party Skill Endorsement","status":"draft","priority":"should","problem":"System-observed interactions (AI dialogue) provide medium-confidence evidence for competency claims. But real proof comes from real people — a teacher who watched a student lead a group, a Meister who assessed a crafted piece, an Azubibotschafter who observed genuine curiosity during a school visit.\n\nThe profile needs a mechanism for trusted third parties to \"give the stamp\" — to endorse specific ","solution":"Build an endorsement system within the Multimodaler Erinnerungsraum (TC-009) that allows trusted people to validate learner competencies.\n\n### Endorsement Flow\n\n1. **Learner or system generates endorsement request**: \"Ask [Herr Mueller, Werkstattleiter] to confirm your woodworking skill\"\n2. **Endorser receives a link** (email, QR code, or in-app if they have an account)\n3. **Endorser sees**: Learn","criteria":["A teacher can endorse a student's skill via a link (no account required for first endorsement)","Endorsements appear in the learner's Erinnerungsraum with endorser identity","Learner can choose which endorsements are visible in their profile","Profile confidence score reflects the mix of evidence sources (AI-only vs. endorsed)","An Azubibotschafter can endorse skills observed during a school visit","Artifacts (photos, documents) can be uploaded and linked to skill dimensions","An endorsed artifact (artifact + third-party validation) is marked as highest-trust evidence","GDPR: endorser consents to data storage; learner consents to endorsement visibility"],"deps":"- TC-009 (Multimodaler Erinnerungsraum — storage and conceptual framework)\n- TC-007 (Portfolio Evidence Layer — evidence structuring)\n- FR-008 (Skill Profile Generation — profile confidence scoring)\n- FR-022 (Company Profile — company-linked endorsers)\n- FR-025 (Eltern-Dashboard — parent-linked endo","notes":"- MVP scope: endorsement via link (no endorser account required). Endorser creates a minimal identity (name + email) to give the stamp.\n- Phase 2: endorser accounts with persistent identity and endorsement history.\n- The endorsement mechanism directly supports the IHK Dresden Azubibotschafter integr"},{"id":"FR-031","title":"3D World Globe Interface","status":"draft","priority":"must","problem":"The VUCA journey needs a visual home — an interface that makes exploration feel like TRAVEL, not like navigating a menu. Students should see a world they want to explore, tap a place, and feel like they're arriving there.","solution":"Build a 3D interactive globe as the primary navigation interface for the VUCA journey.\n\n### Globe Features\n\n| Feature | Description |\n|---|---|\n| **Rotating globe** | Stylized (painted, warm) 3D globe that rotates slowly when idle |\n| **Tap to explore** | Tap any highlighted city to start a station |\n| **Fly-to transition** | Smooth logarithmic zoom from orbital view to city level |\n| **Travel arc","criteria":["Student sees a globe/map they can interact with","Tapping a city starts a smooth transition to that station","Visited stations are visually distinct from unvisited ones","Travel history is visible as arcs/lines between stations","The globe runs at 30+ FPS on a 2023 mid-range Android phone","Two to three \"next destination\" suggestions are highlighted after each station","Passport stamp count is visible on the globe view","The globe works in a mobile browser (Chrome, Safari) — no app store required"],"deps":"- FR-005 (Gemini Dialogue Engine — what happens at each station)\n- FR-006 (VUCA Navigation — lokal/fern choice logic)\n- FR-007 (VUCA Bingo Matrix — invisible tracking of dimension coverage)\n- FR-026 (Micro-Session UX — session duration at each station)\n- DC-011 (3D Gamified World Travel — design con"},{"id":"FR-032","title":"Transit Audio Mode (Reise-Podcast)","status":"draft","priority":"should","problem":"A user said: *\"I want to use the app on the train, and I don't want to read a lot.\"*\n\nMany students commute by train, tram, or bus (especially in Sachsen with DVB/OEPNV). Commute time is 10-30 minutes of potential engagement — but the environment (standing, crowded, noisy) doesn't support full visual interaction or text-heavy reading.","solution":"Build a \"Transit Audio Mode\" (working name: Reise-Podcast) where the AI coach speaks the journey through earphones and the student responds with minimal touch input.\n\n### How It Works\n\n1. **Student plugs in earphones** (or taps \"Audio Mode\" toggle)\n2. **The globe shows ambient animation** — slow rotation, current position glowing, no interaction required\n3. **The AI coach speaks** — narrates the s","criteria":["AI coach speaks all station content via text-to-speech in German","Student can complete a station using only 2-button tap responses (no typing, no reading)","Audio mode sessions are 3-5 minutes","Sessions can be interrupted mid-station and resumed at the exact point","The globe shows ambient animation during audio mode (not blank screen)","Audio mode is suggested when earphones are detected","Audio mode works offline for pre-downloaded stations (Phase 2)","Speech quality is acceptable to teenagers (not robotic — test with real users)"],"deps":"- FR-005 (Gemini Dialogue Engine — generates station content for audio)\n- FR-012 (Session Continuity — interrupt/resume)\n- FR-026 (Micro-Session UX — session duration constraints)\n- FR-031 (3D Globe — ambient animation mode)\n- DC-010 (Experience-First VUCA — audio must be experiential, not lecture)\n","notes":"- Phase 1: Browser-native TTS (free, lower quality). Test with teenagers — if they say \"klingt komisch\", invest in ElevenLabs/Google Cloud TTS for Phase 2.\n- Passive listen mode (no interaction, just story) is the lowest-effort entry: \"Hoer mal rein, was andere Entdecker in Tokyo erlebt haben.\" This"},{"id":"FR-033","title":"Datenschutz for Minors (DSGVO/GDPR Compliance Framework)","status":"draft","priority":"must","problem":"Future Skiller handles content and interaction data for minors (14+). German data protection law is among the strictest in Europe for processing children's data. We must comply with:\n\n| Law | Scope | Key Requirement |\n|---|---|---|\n| **DSGVO Art. 8** (EU GDPR) | Consent for data processing of children | Germany chose **16** as the age threshold. Under 16: parental consent required. |\n| **DSGVO Art","solution":"Build a layered consent and data protection system that is legally compliant AND doesn't destroy the user experience.\n\n### Age-Based User Flows\n\n```\nUser opens app → Login (FR-001/FR-002)\n     │\n     ▼\nAge Gate: \"Wie alt bist du?\"\n     │\n     ├── 16+ → Full consent flow (self)\n     │         User reads & accepts Datenschutzerklaerung\n     │         → Full access\n     │\n     ├── 14-15 → Parental co","criteria":["Age gate blocks users under 14 from creating accounts","Users aged 14-15 trigger parental consent flow","Parental consent email is sent and consent is recorded with timestamp","Limited access mode works while awaiting parental consent (1 station, no persistent data)","Users aged 16+ can consent independently","Datenschutzerklaerung exists in teen-friendly AND legal versions","Account deletion cascades across all data collections","Data export (JSON) is available to every user","No third-party tracking cookies or analytics pixels","Matching consent is separate from general consent, available only 16+","All sponsored content is labeled per JMStV §6","Consent records are immutable and timestamped"],"deps":"- FR-001 (Social Login — login triggers age gate)\n- FR-002 (Email Login — login triggers age gate)\n- FR-003 (Firebase User Data — consent records stored here)\n- FR-025 (Eltern-Dashboard — parent sees child's progress with privacy boundary)\n- FR-028 (Sponsored Content — JMStV compliance)\n- BC-005 (Po","notes":"- The age threshold of 16 for independent consent is German law (DSGVO Art. 8, Germany chose 16). Other EU countries chose 13-16. If Future Skiller expands internationally, age thresholds must be adapted per country.\n- Firebase Auth does NOT enforce age restrictions — we must build the age gate ours"},{"id":"FR-034","title":"UI Theme System (Wrappable Visual Layers)","status":"draft","priority":"should","problem":"The product needs two distinct visual modes (DC-012): a 3D globe \"World Traveler\" mode (80 Days style) and a retro \"Retro Explorer\" mode (Zak McKracken / HD-2D style). The underlying content engine must be identical — only the visual presentation changes.","solution":"Build a skinnable UI architecture where the Smart Kurs engine (DC-009) outputs structured data, and the rendering layer interprets it according to the active theme.\n\n### Theme Architecture\n\n```\nSmart Kurs Engine → Structured Output → Theme Renderer → Screen\n                    {                     ├── Theme A: World Traveler (3D Globe)\n                      station: \"Rome\",    └── Theme B: Retro ","criteria":["Student can choose between two visual themes at first launch","Theme can be switched at any time without losing progress","Same Smart Kurs content renders correctly in both themes","Theme A runs at 30+ FPS on mid-range mobile (3D globe)","Theme B runs at 30+ FPS on mid-range mobile (HD-2D scenes)","Profile, passport, and progress look native in each theme"],"deps":"- DC-012 (Dual UI Paradigm — design concept)\n- DC-009 (Smart Kurse — structured content output)\n- FR-031 (3D World Globe — Theme A implementation)"},{"id":"FR-035","title":"Avatar System (Buddy + Self-Representation)","status":"draft","priority":"should","problem":"Teenagers need a visual identity in the app — something that represents THEM and something that accompanies them. Two avatar needs:\n\n1. **Self-representation**: \"This is ME in the game\" — a customizable character that appears on the globe, in stations, and in social features\n2. **Buddy**: \"This is my companion\" — a small AI character that travels with them, gives hints, celebrates achievements, an","solution":"### The Self-Avatar\n\nA customizable character that represents the student in the world.\n\n| Feature | Details |\n|---|---|\n| Creation | Simple character builder at first launch (face, hair, skin, outfit) |\n| Appearance | Adapts to active theme: illustrated in Theme A, pixel art in Theme B |\n| Position | Visible on the globe (Theme A) or in scenes (Theme B) |\n| Customization | Unlockable outfits, acc","criteria":["Student creates a self-avatar at first launch (< 2 minutes)","Avatar is visible on the globe/map and in social features","Buddy companion appears during journey and reacts to events","Buddy delivers notifications in character","Avatar and buddy adapt visually to the active theme (Theme A / Theme B)","Unlocked items (FR-037) are wearable on the avatar","Avatar config is stored in Firebase and syncs across devices"],"deps":"- FR-034 (UI Theme System — avatar adapts to theme)\n- FR-037 (Items & Individualization — unlockable avatar customization)\n- FR-036 (Team/Partner/Mentor Mode — avatar visible to others)\n- DC-006 (Reisebegleiter-Agenten — buddy is the visible face of the AI companion)\n- DC-014 (Duolingo Engagement — "},{"id":"FR-036","title":"Team, Partner & Mentor Mode (Social + Viral Growth)","status":"draft","priority":"should","problem":"The app needs social mechanics that:\n1. Drive user base growth through invites (viral loop)\n2. Enable collaborative learning (team stations in DC-013)\n3. Allow experienced users to mentor new ones\n4. Give parents, teachers, and Azubibotschafter a natural way to connect with students","solution":"Three social modes that serve different relationships and growth mechanics:\n\n### Mode 1: Partner Mode (1:1)\n\nTwo students explore together. They see each other on the globe, can visit the same station simultaneously, and compare profiles.\n\n| Feature | Details |\n|---|---|\n| Invite | Share a link or QR code: \"Reise mit mir!\" |\n| Shared globe | Both players' positions and travel arcs visible |\n| Co-s","criteria":["Student can invite a partner via link/QR code","Partners see each other on the globe/map","Team stations require 3-5 players and involve role division","Mentor mode allows Level 21+ students to see mentee progress","Teacher and Azubibotschafter accounts can endorse skills","Invite links point to specific stations (contextual)","Both inviter and invitee receive XP on first station completion","No open chat between minors — pre-written reactions only","All social features require additional consent (FR-033)"],"deps":"- DC-013 (Entrepreneur Journey — team stations)\n- DC-014 (Duolingo Engagement — XP bonuses, badges)\n- FR-030 (Third-Party Endorsement — mentor endorsement)\n- FR-033 (Datenschutz — consent for social features)\n- FR-035 (Avatar System — avatars visible to partners/team)\n- FR-037 (Items — shareable/tra"},{"id":"FR-037","title":"Items, Individualization & Seasonal Drops","status":"draft","priority":"should","problem":"Teenagers want to express themselves. They want their experience to be THEIRS — unique, personalized, and showing status. Items serve three purposes:\n1. **Individualization**: Make MY avatar / MY globe / MY passport look different from everyone else's\n2. **Inspiration**: Items that give a thematic boost or open new content\n3. **Advantage**: Items that provide gameplay benefits (more XP, bonus stat","solution":"### Item Categories\n\n| Category | Purpose | Examples |\n|---|---|---|\n| **Cosmetic** | Personalize avatar and UI | Outfits, hats, buddy skins, passport covers, globe themes, trail effects |\n| **Inspiration** | Unlock themed content | \"Kochmuetze\" unlocks 3 bonus culinary stations; \"Werkzeugkasten\" unlocks trades stations |\n| **Advantage** | Gameplay benefits | \"Turbo-Pass\" (double XP for 24h), \"Ent","criteria":["Items drop from stations, achievements, and streaks","Items are categorized as Cosmetic, Inspiration, Advantage, or Social","Seasonal items are only available during their season","A collection album shows all available and earned items","Cosmetic items are applied to avatar, buddy, passport, or globe","Advantage items provide minor, non-essential gameplay benefits","Item rarity is visually indicated (border color + effects)","No items are purchasable with real money","Items can be viewed by partners and team members (social visibility)"],"deps":"- FR-035 (Avatar System — items equip on avatar and buddy)\n- FR-036 (Team/Partner/Mentor Mode — social items, trading)\n- FR-034 (UI Theme System — items adapt to active theme)\n- DC-014 (Duolingo Engagement — items as rewards for engagement milestones)\n- FR-033 (Datenschutz — item drop mechanics must","notes":"- **Not loot boxes.** Items drop as direct rewards for specific actions, not from purchased random boxes. German gambling law (GluStV) restricts loot box mechanics for minors. Our items are engagement rewards, not random purchases.\n- **Seasonal timing aligns with school rhythm**: Fruehling = after w"},{"id":"FR-038","title":"Duolingo-Style Engagement Features","status":"draft","priority":"must","problem":"EdTech apps average 5-8% D30 retention. Duolingo achieves ~15-20%. The difference is entirely in engagement mechanics: streaks, leagues, XP, notifications, achievements. We need the same mechanics adapted for a journey/exploration context.","solution":"Implement the full Duolingo engagement stack as described in DC-014, with Future Skiller adaptations.\n\n### Feature 1: Reisekette (Streak)\n\n| Spec | Value |\n|---|---|\n| Trigger | Complete at least 1 station per calendar day |\n| Display | Flame icon + day count, always visible on home screen |\n| Milestone rewards | 3d (bronze border), 7d (silver), 14d (gold), 30d (badge), 100d (legendary) |\n| Break ","criteria":["Reisekette tracks consecutive days and displays flame icon + count","Streak halves (not zeros) on break","Weekly leagues place 30 users per instance, promote top 10, demote bottom 5","XP is awarded for stations, reflections, endorsements, and invites","Level-up triggers celebration animation","Level gates restrict station access by region (local → global)","Energy system limits free tier to 5 stations/day","20+ achievement badges are available at launch","Push notifications are personalized, max 1/day, opt-out respected","D30 retention measured and tracked as primary KPI"],"deps":"- DC-014 (Duolingo Engagement Model — design specification)\n- FR-035 (Avatar System — buddy delivers notifications, avatar on leaderboard)\n- FR-037 (Items — streak rewards, achievement items, energy items)\n- FR-033 (Datenschutz — notification consent, league data visibility)\n- FR-003 (Firebase — eng"},{"id":"FR-039","title":"SQLite Prompt Tracking + VUCA HeRo-App Parity","status":"in-progress","priority":"must","problem":"Every Gemini API call (requests, prompts, responses) should be logged for debugging, analytics, and development. Currently there is zero logging beyond `console.error`. Additionally, the VUCA journey was a simple chat dialogue instead of the full HeRo-App flow with curriculum generation, module-based courses, quizzes, and VUCA Bingo progress tracking.","solution":"### Part 1: SQLite Prompt Tracking\n- In-browser SQLite database (sql.js) with IndexedDB persistence\n- Two tables: `sessions` (tracking dialogue sessions) and `prompt_logs` (tracking every API call)\n- Logging wrapper around `geminiService` that captures: system prompts, user messages, chat history, raw responses, structured responses, latency, retry count, token estimates\n- Debug panel overlay (Ctr","criteria":["sql.js installed and WASM copied to public/","`services/db.ts` — SQLite init, IndexedDB persistence, CRUD","`services/geminiWithLogging.ts` — logging wrapper for all geminiService methods","`hooks/usePromptLogSession.ts` — session lifecycle hook","`types/promptlog.ts` — TypeScript interfaces for sessions and logs","`components/debug/PromptLogPanel.tsx` — debug overlay with stats, filters, expand/collapse, CSV export","All 4 chat components wired up with prompt logging","`gemini.ts` modified: `onRetry` callback, `generateCurriculum()`, `generateCourse()`","`types/vuca.ts` — Module, CourseContent, QuizQuestion, VucaProgress types","`services/vuca.ts` — VUCA state machine (completeModule, calculateProgress)","`VucaStation.tsx` rewritten: onboarding → curriculum → dashboard → course → bingo → complete","`VucaDashboard.tsx` — module cards grid with category colors","`VucaBingo.tsx` — 4-dimension progress grid","`VucaCourseView.tsx` — course sections + multiple-choice quiz"],"deps":"- FR-005-gemini-dialogue-engine\n- FR-006-vuca-navigation\n- FR-007-vuca-bingo-matrix","notes":"- Debug panel is dev-only, toggled via Ctrl+Shift+L\n- SQLite DB persists across page refreshes via IndexedDB\n- VUCA state persisted to localStorage separately from main app state\n- Favicon added to index.html from images/favicon.ico"},{"id":"FR-040","title":"Docker & Cloud Run Deployment Infrastructure","status":"done","priority":"must","problem":"The frontend app builds and runs locally but has no deployment infrastructure. We need containerized builds and automated deployment to Google Cloud Run.","solution":"Multi-stage Docker build (Node.js build + nginx serve) with Cloud Run deployment via `gcloud run deploy --source .` and GitHub Actions CI/CD on tag push.\n\n### Files Created\n- `Dockerfile` — multi-stage build: node:20-alpine (build) + nginx:1.25-alpine (serve)\n- `nginx.conf` — SPA-aware config with health checks, gzip, cache headers, security headers\n- `.dockerignore` — excludes docs, node_modules,","criteria":["`make docker-build` produces a working Docker image","`make docker-run` serves the app at localhost:8080 with SPA routing","`make deploy` deploys to Cloud Run production (europe-west3)","`make deploy-staging` deploys to staging with max 1 instance","`/_health` endpoint returns 200 for Cloud Run probes","GitHub Actions workflow triggers on `v*` tag push","GEMINI_API_KEY is injected at build time, never stored in image layers","index.html is served with no-cache headers; assets with immutable cache"],"deps":"- FR-013-web-app-deployment\n- TC-011-cloud-run-architecture","notes":"- GCP Project: `future-skillr`, Region: `europe-west3` (Frankfurt)\n- GitHub Actions uses Workload Identity Federation (with SA key fallback commented)\n- Required GitHub secrets: `GCP_WORKLOAD_IDENTITY_PROVIDER`, `GCP_SERVICE_ACCOUNT`, `GEMINI_API_KEY`"},{"id":"FR-041","title":"Root-Level Project Makefile","status":"done","priority":"must","problem":"No unified command interface exists for building, testing, deploying, and managing the project. Developers must remember individual tool commands across frontend, backend, Docker, and GCP.","solution":"A root-level `Makefile` providing standardized targets for all common project operations.\n\n### Targets\n| Target | Description |\n|--------|-------------|\n| `install` | Install frontend npm dependencies |\n| `dev` | Start Vite dev server |\n| `build` | Build frontend for production |\n| `typecheck` | Run TypeScript type checking |\n| `clean` | Remove build artifacts |\n| `docker-build` | Build Docker ima","criteria":["`make help` lists all available targets","`make install` installs frontend dependencies","`make dev` starts the development server","`make build` builds the frontend","Docker and deploy targets require GEMINI_API_KEY","`make api-gen` delegates to `integrations/api-spec/makefile`"],"deps":"- FR-040-docker-cloud-run-deployment","notes":"- Existing makefile at `integrations/api-spec/makefile` is preserved and delegated to via `$(MAKE) -C`."},{"id":"FR-042","title":"GitHub Actions CI/CD Pipeline","status":"done","priority":"must","problem":"No automated deployment pipeline exists. Deployments are manual via `make deploy`, which is error-prone and not reproducible.","solution":"GitHub Actions workflow (`.github/workflows/deploy.yml`) that automatically deploys to Cloud Run when a release tag (`v*`) is pushed.\n\n### Workflow Details\n- **Trigger:** `push.tags: ['v*']`\n- **Authentication:** Google Workload Identity Federation (with commented SA key fallback)\n- **Deploy command:** `gcloud run deploy --source . --build-arg GEMINI_API_KEY=... --quiet`\n- **Output:** Prints the d","criteria":["Workflow triggers only on `v*` tag pushes","Uses Workload Identity Federation for keyless auth","Deploys to Cloud Run with correct project/region/service","GEMINI_API_KEY injected from GitHub secrets","Deployment URL printed as final step"],"deps":"- FR-040-docker-cloud-run-deployment","notes":"- To deploy: `git tag v0.1.0 && git push origin v0.1.0`\n- SA key auth is commented out as a fallback option in the workflow file."},{"id":"FR-043","title":"Admin Panel","status":"in-progress","priority":"must","problem":"The application has no admin interface. All content (prompts, journeys, stations) is hardcoded. Administrators need a way to manage users, roles, and content without code changes.","solution":"Add an Admin Console accessible only to users with the `admin` role. The console provides tabs for User Administration, Role Management, and Meta Kurs Editor.","criteria":["Admin Console is accessible via \"Admin\" button in the header (visible only to admin users)","Console has three tabs: Benutzer, Rollen, Meta Kurs Editor","Non-admin users cannot see or access the Admin button","Admin can navigate back to the main app from the console"],"deps":"- FR-044 (Role Management)\n- FR-045 (Meta Kurs Editor)\n- FR-046 (User Administration)\n- FR-047 (Management Console)\n- TC-001 (Firebase Data Model — future migration from localStorage)","notes":"MVP implementation uses localStorage for data persistence. Firebase migration planned for production."},{"id":"FR-044","title":"Role Management","status":"in-progress","priority":"must","problem":"The application has no user roles. All users have the same access level. Administrators need to be distinguished from regular users to control access to management features.","solution":"Implement a role system with two roles: `admin` and `user`. The first registered user automatically receives the `admin` role. All subsequent users receive the `user` role by default. Admins can promote/demote users through the Role Manager interface.","criteria":["Two roles exist: `admin` and `user`","First registered user is automatically assigned `admin` role","Subsequent users are assigned `user` role by default","Admins can change any other user's role","Admins cannot demote themselves","Role changes take effect immediately","Role Manager shows users grouped by role with quick toggle"],"deps":"- FR-043 (Admin Panel)\n- FR-046 (User Administration)","notes":"Role data is stored in localStorage as part of the UserRecord. Admin self-demotion is prevented to avoid lockout scenarios."},{"id":"FR-045","title":"Meta Kurs Editor (Prompt & Journey Manager)","status":"in-progress","priority":"must","problem":"All AI prompts, journey definitions, and station configurations are hardcoded in TypeScript constants. To iterate on content, educators and admins currently need developer access and code changes.","solution":"Build a Meta Kurs Editor within the Admin Console that allows editing:\n1. **System Prompts**: Edit the AI system prompts for onboarding, VUCA station, entrepreneur station, and self-learning station\n2. **Journey Definitions**: Edit journey metadata (title, subtitle, description, icon, dimensions) and add new journeys from templates\n3. **Station Definitions**: Edit station metadata (title, descript","criteria":["Admin can edit all 4 system prompts (onboarding, VUCA, entrepreneur, self-learning)","Edited prompts are used when starting new journeys","Admin can edit journey titles, subtitles, descriptions, and icons","Admin can add new journeys via \"Add Journey\" button","Admin can edit station titles, descriptions, settings, and characters","\"Reset to Default\" restores original hardcoded values per section","\"Reset All\" restores all sections at once","Export/Import JSON for backup and sharing configurations","Changes persist across browser sessions (localStorage)"],"deps":"- FR-043 (Admin Panel)","notes":"The content resolver pattern (`getPrompts()`, `getJourneys()`, `getStations()`) allows seamless migration to a server-side storage later. Components call resolver functions instead of importing constants directly."},{"id":"FR-046","title":"User Administration","status":"in-progress","priority":"must","problem":"There is no authentication or user management. The app is open to anyone without login. Admins need to manage registered users.","solution":"Implement localStorage-based authentication with:\n1. **Login page**: Email + password login form\n2. **Registration**: Email + display name + password registration\n3. **User Admin panel**: Table of all users with role change and delete actions\n4. **Session management**: Login persists via localStorage session token\n\nPassword hashing uses SHA-256 (MVP placeholder; Firebase Auth planned for productio","criteria":["Login page is shown when no session exists","Users can register with email, name, and password","Users can log in with email and password","Invalid credentials show error message","Duplicate email registration is prevented","Admin can see list of all registered users","Admin can change user roles","Admin can delete users (except themselves)","Logout clears session and returns to login page","Auth state persists across page reloads"],"deps":"- FR-044 (Role Management)\n- FR-043 (Admin Panel)","notes":"SHA-256 client-side hashing is an MVP placeholder. Production will use Firebase Auth with proper server-side password handling."},{"id":"FR-047","title":"Management Console","status":"in-progress","priority":"must","problem":"There is no central place for administrators to manage the application. Admin functions (user management, role management, content editing) need a unified interface.","solution":"Create a Management Console component that serves as the top-level container for all admin functionality. The console:\n1. Shows the current admin user and their role\n2. Provides tab navigation between: Users, Roles, Meta Kurs Editor\n3. Is accessible only to users with `admin` role\n4. Can be entered via the \"Admin\" button in the app header\n5. Provides a \"Back to App\" button to return to normal use","criteria":["Management Console is only accessible to admin-role users","Console displays current admin user info","Tab navigation works between Users, Roles, and Meta Kurs Editor","\"Back to App\" returns to the landing page","Console uses the same visual design language as the main app (glass, gradients)"],"deps":"- FR-043 (Admin Panel)\n- FR-044 (Role Management)\n- FR-045 (Meta Kurs Editor)\n- FR-046 (User Administration)","notes":"The Management Console is a view state in the main App component (`view: 'admin'`), rendered inside the Layout with full header/footer chrome."},{"id":"FR-048","title":"Journey Progress on Landing Page Cards","status":"draft","priority":"should","problem":"When a user has started a journey but not yet completed all stations, there is no visual indication of progress on the landing page cards. The user cannot see which journeys have open goals remaining or how far they have progressed. This makes it hard to decide where to continue.","solution":"Display station progress on each journey card on the landing page. Each card shows a progress indicator (e.g. \"2 / 4 Stationen\") representing how many stations the user has completed out of the total available. Journeys with remaining open stations are visually highlighted to encourage continuation.\n\nClicking a card with open stations takes the user directly back into that journey (reusing the exi","criteria":["Each journey card on the landing page shows the number of completed vs. total stations (e.g. \"2 / 4 Stationen\")","Cards with zero progress show no progress indicator (or \"Noch nicht gestartet\")","Cards with partial progress are visually distinct (e.g. highlighted border, progress bar, or badge)","Cards with all stations completed show a completion state (e.g. checkmark, \"Abgeschlossen\")","Progress data is read from the persisted user profile (`journeyProgress`)","Clicking a card with open stations navigates directly into the journey"],"deps":"- FR-006 (VUCA navigation)\n- FR-012 (Session continuity — persisted progress)\n- FR-014 (Interest profile tracking)","notes":"The landing page cards were recently made clickable (direct entry into stations). This FR extends them with progress visibility so users know where to continue."},{"id":"FR-049","title":"Profile Page with Activity History","status":"draft","priority":"should","problem":"The current profile view (CombinedProfile) is only reachable after completing a station or from the journey selector. There is no way to open the profile directly from the landing page or main navigation. Additionally, the profile only shows aggregated skill scores — it does not display the user's activity history (inputs, selections, AI questions, dialogue turns).","solution":"Create a directly accessible profile page that shows:\n\n1. **Skill/Interest Profile** — the existing radar chart and dimension scores (as in CombinedProfile)\n2. **Activity History** — a chronological log of all persisted user activities:\n   - User text inputs and selections during dialogues\n   - AI coach questions and responses\n   - Station entries and completions\n   - Onboarding insights captured\n","criteria":["Profile page is accessible directly from the landing page or top navigation","Profile shows the existing skill/interest visualization (radar chart, dimension scores)","Profile shows a chronological activity history with all user interactions","Each history entry displays: timestamp, type (input/question/selection/milestone), and content","History includes AI coach questions alongside user responses","History is filterable or groupable by journey/station","Activity data is read from persisted storage (localStorage or Firebase)","Empty state is shown when the user has no history yet"],"deps":"- FR-008 (Skill profile generation)\n- FR-009 (Profile visualization)\n- FR-012 (Session continuity)\n- FR-039 (Prompt log SQLite — may serve as history data source)","notes":"The Travel Journal concept (DC domain) aligns with this feature — the activity history is effectively the user's personal travel journal across all journeys. The existing `stationResults` and `promptLog` data structures may already contain much of the needed data; the main work is surfacing it in a "},{"id":"FR-050","title":"User Behavior Tracking (Clickstream Analytics)","status":"in-progress","priority":"should","problem":"We have no visibility into how users navigate the app, where they drop off in the journey funnel, or how they interact with the AI chat. Without behavioral data we cannot optimize the VUCA journey flow, identify UX bottlenecks, or measure engagement.","solution":"Implement client-side clickstream analytics that tracks every meaningful user interaction as timestamped events stored in the existing SQLite dev backend. Events capture navigation patterns, journey lifecycle, and chat interaction metadata — never message content or personal data.\n\n### Event Types\n\n| Event | Trigger | Key Properties |\n|-------|---------|----------------|\n| `page_view` | Every View","criteria":["All 9 event types are captured during normal app usage","Events are batched client-side (2s flush) with `sendBeacon` on tab close","Admin dashboard shows conversion funnel, journey popularity, session replay","CSV export works for all events","No personal data or message content is stored in anonymous clickstream events","Dialog flows capture full conversation content, timing, and flow in profile-scoped storage (IntroState)","`intro-fast-forward` event tracked when user skips intro chat via \"Weiter >\"","TypeScript compiles without errors"],"deps":"- FR-047: Management Console (admin panel infrastructure)\n- TC-012: Clickstream Analytics Architecture","notes":"This is a development/analytics tool. In production, events would be sent to a proper analytics backend (e.g., BigQuery). The SQLite implementation is suitable for the MVP phase."},{"id":"FR-051","title":"Secure API Gateway","status":"done","priority":"must","entity":"SkillR","gate":"env:all","problem":"Multiple secret keys are currently exposed or at risk of exposure in the client bundle:\n\n1. **Gemini API key** — baked into the Vite JS bundle via `define` in `vite.config.ts`. Anyone opening DevTools can extract it.\n2. **Firebase config** — currently hardcoded in frontend source. While Firebase config is not strictly secret, exposing it without server-side control means no ability to rotate or re","solution":"Build a **Secure API Gateway** on the existing Express server that wraps ALL secret keys server-side and provides runtime configuration. The gateway has three layers:\n\n### Layer 1: Gemini Proxy (`/api/gemini/*`)\n\nSeven endpoints mirror the seven `geminiService` methods currently calling the Gemini SDK from the browser:\n\n| Endpoint | Current Client Method | Payload |\n|----------|-------------------","criteria":["Gemini API key does NOT appear in the JS bundle (verify: `curl <app-url>/assets/*.js | grep AIza` returns nothing)","All 7 Gemini methods work through `/api/gemini/*` proxy endpoints","TTS endpoint accepts text and returns base64 audio","STT endpoint accepts base64 audio and returns transcription text","`GET /api/config` returns Firebase configuration as JSON","Firebase config values do NOT appear in the JS bundle as hardcoded strings","App initializes Firebase SDK from `/api/config` response","`/api/agents/*` namespace returns 501 Not Implemented (reserved)","Rate limiting returns 429 on rapid requests (>30/min for chat)","`GEMINI_API_KEY` is a runtime env var in Cloud Run (not a build-time arg)","All Firebase config values are runtime env vars in Cloud Run","Cloud Run serves both static files and API from a single container","All existing UI flows work without modification (geminiService interface unchanged)","Health check endpoint at `/api/health` returns 200","Error responses use structured JSON format"],"deps":"- FR-005: Gemini Dialogue Engine (defines the 7 methods being proxied)\n- FR-052: Docker Compose Local Staging (local testing of the gateway)\n- TC-016: Secure API Gateway Architecture (architecture decision)\n- FR-040: Docker & Cloud Run (container deployment)\n- FR-024: Multi-Agent Reisebegleiter (fut","notes":"- No streaming needed for MVP — all current calls are request/response and the UI already handles latency with loading indicators.\n- The existing Express dev server (`frontend/server/index.ts`) already has routes, SQLite, and Vite proxy. The gateway routes extend this server for production use.\n- TT"},{"id":"FR-052","title":"Docker Compose Local Staging","status":"done","priority":"must","entity":"SkillR","gate":"env:all","problem":"There is no way to test the full production stack locally. The current development workflow uses `npm run dev` (Vite dev server), which differs significantly from the production setup:\n\n- Dev server uses Vite's HMR and dev middleware; production uses compiled static files + Express\n- Dev server does not run the API gateway (FR-051) in production mode\n- Environment variables are handled differently","solution":"A `docker-compose.yml` at the project root that builds and runs the same `Dockerfile` used for Cloud Run, injecting environment variables from a local `.env` file.\n\n### docker-compose.yml\n\n```yaml\nservices:\n  app:\n    build: .\n    ports:\n      - \"9090:8080\"\n    env_file: .env.local\n    environment:\n      - PORT=8080\n```\n\n### Environment File\n\n`.env.local` (gitignored) contains all gateway env vars","criteria":["`docker-compose.yml` exists at project root","`make local-stage` builds and starts the container","App is accessible at `http://localhost:9090`","All `/api/gemini/*` proxy routes work through the container","`GET /api/config` returns Firebase config from env vars","`GET /api/health` returns 200","`.env.example` documents all required variables","`.env.local` is in `.gitignore`","Container uses the same `Dockerfile` as Cloud Run deployment","`docker compose down` cleanly stops the container"],"deps":"- FR-051: Secure API Gateway (the gateway being tested)\n- FR-040: Docker & Cloud Run (the Dockerfile being reused)\n- TC-016: Secure API Gateway Architecture (architecture decision)","notes":"- This is intentionally simple — a single service, no sidecar containers, no local Firebase emulator (yet).\n- The Firebase emulator suite could be added as a second service in V1.0 for offline development.\n- Developers still use `npm run dev` for fast iteration on frontend code. `make local-stage` i"},{"id":"FR-053","title":"Agent Consent Dashboard","status":"draft","priority":"must","entity":"maindset.ACADEMY | maindfull.LEARNING","gate":"role:admin","problem":"The platform runs multiple AI agents (Entdecker, Reflexions, Skill, Match) that access user data in SOLID Pods. Users currently have no visibility into which agents access their data, what data each agent reads/writes, or the ability to control optional agent access. TC-020 introduces per-agent identity and tiered consent, but there is no user-facing interface to manage it.\n\nUsers need a clear, ag","solution":"A consent management dashboard accessible from **Einstellungen → Meine Daten & KI-Agenten** that displays agent access status and provides consent controls.\n\n### Dashboard Layout\n\n```\n┌──────────────────────────────────────────────────────┐\n│ Meine Daten & KI-Agenten                             │\n│                                                      │\n│ Diese KI-Agenten helfen dir auf deiner Reis","criteria":["Dashboard shows all 4 agents with correct name, description, and data access info","Core agents display \"Erforderlich\" badge (not toggleable)","Optional agents (Match-Agent) display toggle switch","Toggle ON triggers consent grant API call and updates Pod ACL","Toggle OFF triggers consent revoke API call and removes Pod ACL","Consent changes take immediate effect (verified by agent execution test)","Under-16 users see only core agents (optional agents and fine-tuning hidden)","Fine-tuning opt-in toggle is separate from agent toggles","Confirmation dialog shown before granting or revoking consent","Error states handled gracefully (toast notification, toggle revert)","Audit trail shows recent agent access with timestamp, agent name, and containers","All user-facing text is in German","Dashboard is accessible from Einstellungen → \"Meine Daten & KI-Agenten\"","Data container paths are translated to German labels (not raw paths)"],"deps":"- [TC-020](../arch/TC-020-bot-fleet-identity.md) — Bot Fleet Identity (agent WebIDs, tiered consent, ACL model)\n- [TC-019](../arch/TC-019-solid-pod-storage-layer.md) — SOLID Pod Storage Layer (Pod ACL management)\n- [TC-018](../arch/TC-018-agentic-backend-vertexai.md) — Agentic Backend (AgentConfig s","notes":"- The dashboard uses the same design language as the rest of the settings UI (FR-006 settings pattern)\n- Agent icons and colors should match the agent personas defined in DC-006\n- The \"Mehr erfahren\" link on the fine-tuning card opens a modal with the detailed explanation from the Datenschutzerklaer"},{"id":"FR-054","title":"Pre-Login Intro-Sequenz mit KI-Coach Avataren","status":"done","priority":"must","entity":"maindset.ACADEMY | maindfull.LEARNING","gate":"env:dev","problem":"Besucher muessen sich aktuell anmelden, bevor sie das Produkt erleben koennen. Das ist eine hohe Huerde fuer Jugendliche (14+). Die Conversion-Rate vom Erstkontakt zur Registrierung ist niedrig.","solution":"Eine Intro-Sequenz laesst neue User **vor der Registrierung** mit einem von 6 KI-Coach-Charakteren chatten, 5 Smalltalk-Fragen beantworten, eine Mini-Skill-Sequenz absolvieren und dabei einen Skillpunkt (25 XP) verdienen. Erst danach kommt die Registrierung mit DSGVO-Altersgate. Der verdiente Skillpunkt wird ins echte Profil uebertragen.\n\n### Ablauf\n\n```\nWelcomePage (\"Jetzt ausprobieren\")\n    ↓\n1.","criteria":["WelcomePage zeigt \"Jetzt ausprobieren\" Button","Coach-Auswahl-Seite mit 6 Personas im 2x3 Grid","IntroChat mit Smalltalk (5 Fragen) und nahtlosem Demo-Uebergang","Marker [SMALLTALK_DONE] und [DEMO_COMPLETE] werden erkannt und aus der Anzeige entfernt","IntroRegisterPage mit DSGVO-Altersgate (unter 14 blockiert, 14-15 Eltern-Hinweis, 16+ normal)","Intro-State wird in localStorage gespeichert und bei Registrierung ins Profil uebertragen","Anonymes Rate-Limiting: 15 Requests / 5 Min fuer unauthentifizierte Gemini-Anfragen","XPAction 'intro_demo_complete' (25 XP) im Engagement-System","\"Weiter >\" link in intro-chat header skips to intro-register","Fast-forward sets `fastForward: true` in IntroState and tracks `intro-fast-forward` event","Alle bestehenden Tests bestehen weiterhin"],"deps":"- FR-033 (DSGVO-Altersgate Konzept)\n- TC-016 (Gemini Server Proxy)","notes":"- Intro-State wird komplett in localStorage gehalten (kein Firestore fuer anonyme User)\n- Die Intro-Sequenz benoetigt ca. 10 Gemini-API-Calls (6 Smalltalk + 4 Demo)\n- Bei Wiederbesuch kann der Intro-State aus localStorage wiederhergestellt werden"},{"id":"FR-055","title":"Local Development TLS/HTTPS Support","status":"done","priority":"must","entity":"SkillR","problem":"The Web Speech API (`navigator.mediaDevices.getUserMedia`) requires a secure context (HTTPS) to access the microphone. In local development, the servers run on HTTP by default, which means voice input features do not work during development and testing.","solution":"Add automatic TLS/HTTPS support to both the Vite dev server and the Express API gateway when local certificates are available.\n\n### Components\n\n1. **Certificate generation script** (`scripts/generate-dev-cert.sh`)\n   - Prefers `mkcert` (adds to system trust store, no browser warnings)\n   - Falls back to `openssl` (self-signed, browser will warn)\n   - Outputs to `.certs/localhost-key.pem` and `.cer","criteria":["`scripts/generate-dev-cert.sh` generates valid TLS certificates","Vite dev server serves on HTTPS when certs exist","Express API gateway serves on HTTPS when certs exist","Proxy from Vite to Express works over HTTPS","`getUserMedia` (microphone) works in the browser","`.certs/` is git-ignored","Servers fall back to HTTP gracefully when no certs are present","Console output indicates TLS status clearly"],"deps":"- FR-054: Intro Sequence (voice input in pre-login chat)\n- FR-032: Transit Audio Mode (TTS requires secure context for some browsers)","notes":"- `mkcert` is recommended for the best developer experience (no browser warnings): `brew install mkcert`\n- Self-signed certificates from `openssl` will trigger browser warnings — click \"Advanced\" → \"Proceed\" to continue\n- Certificates are valid for `localhost`, `127.0.0.1`, and `::1`"},{"id":"FR-056","title":"Server-Side Authentication & Session Management","status":"done","priority":"must","entity":"SkillR","problem":"The frontend Express server has **no authentication middleware** on sensitive routes (`/api/users`, `/api/prompt-logs`, `/api/analytics`). Login returns user data without issuing a JWT or session token — auth state is client-side only and trivially spoofable via DevTools. The Go backend's v1 group claims auth middleware is \"added in main.go\" but it is never wired. Any anonymous user can list all u","solution":"### Frontend Express server\n1. **Issue JWT on login** — After successful password verification in `auth.ts`, sign a JWT (HS256, secret from env var `JWT_SECRET`) with claims `{ sub, email, role }` and 24h expiry. Return it in the response body.\n2. **Auth middleware** — Create `requireAuth` middleware that verifies the JWT from `Authorization: Bearer <token>`. Apply it to all routes except `/api/au","criteria":["`POST /api/auth/login` returns a JWT in the response body","`GET /api/users` returns 401 without a valid JWT","`GET /api/users` returns 403 with a valid non-admin JWT","`PATCH /api/users/:id/role` returns 403 for non-admin","`DELETE /api/users/:id` returns 403 for non-admin","`GET /api/prompt-logs` returns 403 for non-admin","`GET /api/analytics` returns 403 for non-admin","Go backend v1 group rejects requests without valid Firebase JWT (401)","JWT_SECRET is loaded from env var, not hardcoded","Unit tests cover: valid token, expired token, missing token, wrong role"],"deps":"- FR-051 (API Gateway) — MVP3, provides the Express server structure\n- TC-025 (Security Hardening Phase)","notes":"- The frontend Express server JWT is separate from Firebase Auth JWT used by the Go backend. Both auth paths must work.\n- Consider migrating to Firebase Auth for the Express server in V1.0 to unify auth. For now, local JWT is faster to implement."},{"id":"FR-057","title":"Admin Access Control & Credential Hygiene","status":"done","priority":"must","entity":"SkillR","problem":"Admin routes in the Go backend (`/api/v1/prompts`, `/api/v1/agents`) lack the `RequireAdmin()` middleware — any authenticated user can modify AI prompts and invoke agents. Both the Go backend and frontend Express server seed a hardcoded admin account with password `skillr`, logged to stdout. The first-user-gets-admin logic has a race condition where a failed DB query silently grants admin role.\n\n*","solution":"### Go backend\n1. **Wire `RequireAdmin()` middleware** to the `/prompts` and `/agents` route groups in `routes.go`:\n   ```go\n   prompts := v1.Group(\"/prompts\", middleware.RequireAdmin())\n   agents := v1.Group(\"/agents\", middleware.RequireAdmin())\n   ```\n2. **Remove hardcoded admin seed** from `auth.go:251`. Replace with:\n   - Read `ADMIN_SEED_EMAIL` and `ADMIN_SEED_PASSWORD` from env vars\n   - Ski","criteria":["`PUT /api/v1/prompts/:id` returns 403 for non-admin authenticated user","`PUT /api/v1/agents/:id` returns 403 for non-admin authenticated user","No hardcoded passwords in source code (`grep -r \"skillr\" backend/ frontend/` returns 0 results)","Admin seed only runs when `ADMIN_SEED_EMAIL` + `ADMIN_SEED_PASSWORD` env vars are set","No credentials printed to stdout/logs","Concurrent first-user registration does not create multiple admins","Unknown role values in Firebase token are rejected (default to \"user\")","`SetTestUserInfo` is not exported in production middleware package"],"deps":"- FR-056 (Auth & Sessions) — admin auth builds on the auth middleware\n- TC-025 (Security Hardening Phase)","notes":"- Update `.env.example` with `ADMIN_SEED_EMAIL=` and `ADMIN_SEED_PASSWORD=` placeholders.\n- Update local dev docs to explain the new seeding approach."},{"id":"FR-058","title":"API Input Validation & AI Prompt Security","status":"done","priority":"must","entity":"SkillR | maindfull.LEARNING","problem":"The Gemini proxy allows clients to override the entire `systemInstruction`, enabling prompt injection that can reveal internal logic or generate harmful content. Neither backend nor frontend validates input lengths — a single large message can trigger excessive Vertex AI token consumption (cost attack). User-supplied values (`journeyType`, `stationId`, `goal`, extracted interests) are interpolated","solution":"### Remove client control of system prompts\n1. **Server-side prompt registry** — Define allowed system prompts by key (e.g., `\"onboarding\"`, `\"vuca-station\"`, `\"reflection\"`) on the server. Client sends `promptKey` instead of `systemInstruction`.\n2. **Reject client-supplied `systemInstruction`** — If the field is present in the request body, ignore it (or return 400).\n3. **Validate `history`** — E","criteria":["Client cannot override `systemInstruction` — field is ignored or rejected","`userMessage` longer than 2,000 chars returns 400 from Express proxy","`chatHistory` with >50 messages returns 400","`Message` longer than 10,000 chars returns 400 from Go backend","`journeyType` must be one of known values, else 400","Invalid JSON from AI model returns structured error, not raw text","`rawText` is not present in production Gemini proxy responses","Admin prompt test endpoint does not leak internal error details","Unit tests for each validation rule"],"deps":"- FR-051 (API Gateway) — prompt registry lives in the gateway\n- FR-076 (Solid Pod Connection) — Pod endpoint validation\n- TC-025 (Security Hardening Phase)","notes":"- The prompt registry can start simple: a `Map<string, string>` loaded from config or DB. The Meta Kurs editor (FR-045) can manage prompts through this registry in V1.0.\n- Cost monitoring on the Gemini API should be set up as a complementary control."},{"id":"FR-059","title":"Security Headers, CORS & Error Handling","status":"done","priority":"must","entity":"SkillR","problem":"The frontend Express server uses `cors()` with no arguments — all origins allowed. No security headers (CSP, HSTS, X-Frame-Options) are set. Internal error messages including stack traces, config errors, and file paths are sent directly to clients. The Go backend has duplicate CORS configuration and defaults to localhost origins if `ALLOWED_ORIGINS` is unset. The health endpoint leaks infrastructu","solution":"### CORS\n1. **Frontend Express** — Replace `cors()` with explicit origin allowlist from `ALLOWED_ORIGINS` env var. Fail startup if not set in production (`NODE_ENV=production`).\n2. **Go backend** — Remove duplicate `cors.go` file. Keep the single CORS config in `server.go`. Require explicit `ALLOWED_ORIGINS` in production (reject startup if unset and not in dev mode).\n3. **Reject wildcard** — Both","criteria":["`curl -H \"Origin: https://evil.com\" /api/health` does not return `Access-Control-Allow-Origin: https://evil.com`","Response headers include `Strict-Transport-Security`, `X-Frame-Options: DENY`, `X-Content-Type-Options: nosniff`","`Content-Security-Policy` header is present and blocks inline scripts","500 errors return `{\"error\": \"Internal server error\"}` — no stack traces, no file paths","`/api/health` public response contains only status strings, no hostnames or connection details","Server refuses to start in production without `ALLOWED_ORIGINS` set","`ALLOWED_ORIGINS=*` is rejected at startup","Go backend has a single CORS configuration (no duplicate `cors.go`)"],"deps":"- FR-051 (API Gateway)\n- TC-025 (Security Hardening Phase)","notes":"- CSP will need tuning as new frontend features are added. Start restrictive, loosen as needed.\n- The `helmet` npm package handles most headers with sensible defaults."},{"id":"FR-060","title":"Rate Limiting & Abuse Prevention","status":"done","priority":"must","entity":"SkillR","problem":"The frontend rate limiter grants the higher (authenticated) rate limit to any request with an `Authorization` header — the token is never validated. The Go backend rate limiter fails open: Redis errors or misconfiguration disables rate limiting entirely. The public endorsement submit endpoint has no auth or rate limiting — vulnerable to spam. Login endpoints have no brute-force protection. IP-base","solution":"### Frontend Express\n1. **Validate token before granting auth rate limit** — In `rateLimit.ts`, verify the JWT (from FR-056) before applying the authenticated rate limit tier. Invalid/missing tokens get the anonymous tier.\n2. **Brute-force protection on login** — After 5 failed login attempts for the same email within 15 minutes, block further attempts for that email for 15 minutes. Return 429.\n3.","criteria":["Request with `Authorization: garbage` gets anonymous rate limit, not authenticated tier","6th failed login for same email within 15 minutes returns 429","Redis connection failure does not disable rate limiting — in-memory fallback activates","`POST /api/v1/portfolio/endorsements` without rate limiting returns 429 after threshold","IP spoofing via `X-Forwarded-For` does not bypass rate limits (Echo uses configured IP extractor)","Anonymous Gemini abuse beyond threshold is blocked","Unit tests for: rate limit tier selection, brute-force lockout, Redis failover"],"deps":"- FR-056 (Auth & Sessions) — JWT validation used for rate limit tier\n- FR-051 (API Gateway)\n- FR-076 (Solid Pod Connection) — Pod endpoint protection\n- TC-025 (Security Hardening Phase)","notes":"- In-memory rate limiting is sufficient for single-instance Cloud Run. Multi-instance requires Redis (V1.0 scale concern).\n- The endorsement invitation token pattern can reuse the portfolio sharing mechanism from FR-030.\n- Pod sync rate limiting deferred to V1.0 — MVP4 is dev-only with on-demand man"},{"id":"FR-061","title":"Infrastructure & Supply Chain Hardening","status":"done","priority":"should","entity":"SkillR","problem":"The `credentials/` directory is not in `.gitignore` — service account keys placed there for local Docker development could be accidentally committed. The CI/CD pipeline passes an unused `_GEMINI_API_KEY` to Cloud Build, exposing the secret for no purpose. Deployment scripts pass secrets inline via `--set-env-vars`, visible in process listings and shell history. Docker Compose exposes Postgres and ","solution":"### .gitignore\n1. Add `credentials/` to `.gitignore`\n2. Add `*.pem` and `*.key` as safety-net patterns\n\n### CI/CD\n3. **Remove dead `_GEMINI_API_KEY` substitution** from `.github/workflows/deploy.yml`\n4. **Pin GitHub Actions to commit SHAs** — Replace `@v4` / `@v2` with full SHA digests\n5. **Pin Docker base images to SHA digests** — `node:20-alpine@sha256:...`, `golang:1.24-alpine@sha256:...`\n\n### ","criteria":["`git add credentials/test-key.json` is rejected by `.gitignore`","`git add stray.pem` is rejected by `.gitignore`","`grep _GEMINI_API_KEY .github/workflows/deploy.yml` returns 0 results","GitHub Actions in `deploy.yml` use full commit SHA pins","Docker base images in `Dockerfile` use `@sha256:` digests","`make deploy` does not show secrets in `ps aux` output","`docker-compose up` binds Postgres to 127.0.0.1 only","`docker-compose up` binds Redis to 127.0.0.1 only"],"deps":"- TC-025 (Security Hardening Phase)","notes":"- SHA pinning requires periodic updates when base images release security patches. Consider Dependabot or Renovate for automated PR creation.\n- The `--env-vars-file` approach requires the temp file to be created securely (mode 0600) and deleted in a trap handler."},{"id":"FR-062","title":"Warteraum-Integration in Coach-Auswahl","status":"done","priority":"must","entity":"maindset.ACADEMY","gate":"mvp3","problem":"Bei hoher Last (nach Ad-Kampagnen) bekommen Nutzer 429-Fehler von der Gemini-API. Es gibt keine Warteschlange oder Entertainment fuer wartende Nutzer.","solution":"Die CoachSelectPage wird zum Warteraum erweitert. Bei hoher Last wird die Entertainment-Sektion (Videos, Audio, Coach-Vorschau) betont. Bei niedriger Last ist sie sichtbar, aber ueberspringbar. Ein serverseitiger Capacity-Tracker steuert die Gemini-Session-Vergabe.\n\n### Neue Dateien\n| Datei | Zweck |\n|-------|-------|\n| `frontend/server/routes/capacity.ts` | `GET /api/capacity`, `POST /api/capacit","criteria":["Bei `MAX_CONCURRENT_GEMINI_SESSIONS` erreicht → Warteraum-Sektion wird betont","Queue-Position und geschaetzte Wartezeit werden alle 5s aktualisiert","User wird automatisch zum IntroChat weitergeleitet wenn Slot frei","Email-Termin-Buchung speichert Slot-Reservierung","Direkte API-Calls zu `/api/gemini/chat` geben 503 bei Kapazitaet voll","Bei niedrigerer Last: Warteraum-Sektion sichtbar aber ueberspringbar","Graceful Degradation: Wenn `/api/capacity` fehlschlaegt → direkt durchlassen","`QUEUE_ENABLED=false` deaktiviert das Feature komplett (default: false)","Eingeloggte Nutzer passieren den Warteraum frei"],"deps":"- TC-026 (Warteraum Architecture)\n- FR-060 (Rate Limiting)\n- FR-063 (Visitor Lifecycle Tracking)","notes":"Implementierung in 2 Phasen: Kapazitaets-Infrastruktur (Server), dann UI (Frontend)."},{"id":"FR-063","title":"Visitor-Lifecycle-Tracking","status":"done","priority":"should","entity":"SkillR","gate":"mvp3","problem":"Es gibt kein Tracking fuer Visitor-Arrival, Dropout, und Conversion. Absprungverhalten bei Ad-Kampagnen kann nicht analysiert werden.","solution":"5 neue Event-Types im bestehenden Analytics-System: `visitor_arrived`, `visitor_waiting`, `visitor_entered`, `visitor_dropped`, `visitor_converted`. Diese werden in die bestehende SQLite-basierte Tracking-Pipeline integriert.\n\n### Neue Event-Types\n\n| Event | Wann | Properties |\n|-------|------|-----------|\n| `visitor_arrived` | Erster App-Mount | referrer, viewport, utm_*, arrived_at |\n| `visitor_","criteria":["`visitor_arrived` feuert bei erstem Page-Load mit Referrer und Viewport","`visitor_dropped` feuert via `sendBeacon` bei Tab-Close fuer nicht-konvertierte Besucher","`visitor_converted` feuert bei erfolgreicher Registrierung mit Time-to-Convert","Drop-off-Rate pro View und Warteraum-Status in Admin-Overview sichtbar","Erweiterter Conversion-Funnel: Arrived → Coach-Select → Waiting → Entered → Completed → Registered","Keine PII in Events (kein Email, kein Name — nur browser_session_id)","Alle bestehenden Tests passen weiterhin"],"deps":"- FR-050 (bestehendes Analytics-System)","notes":"Internes Analytics funktioniert ohne Cookie-Consent (kein PII, First-Party only)."},{"id":"FR-064","title":"Campaign-Attribution und Meta-Pixel","status":"done","priority":"could","entity":"maindset.ACADEMY","gate":"mvp3","problem":"Kein Campaign-Attribution (UTM, fbclid). Kein Meta Pixel. ROI von Ad-Kampagnen kann nicht gemessen werden.","solution":"UTM-Parameter von URL beim ersten Besuch erfassen und in sessionStorage speichern. Meta Pixel nur nach Cookie-Consent laden. UTM-Params an alle Analytics-Events mergen.\n\n### Neue Dateien\n| Datei | Zweck |\n|-------|-------|\n| `frontend/services/campaignAttribution.ts` | UTM-Capture, sessionStorage, Retrieval |\n| `frontend/services/metaPixel.ts` | Meta Pixel Init, Standard-Events |\n\n### UTM-Paramete","criteria":["UTM-Parameter von URL beim ersten Besuch erfasst und in sessionStorage gespeichert","`fbclid` und `gclid` erfasst","UTM-Params an alle Analytics-Events in `properties` angehaengt","Meta Pixel Script nur geladen wenn `META_PIXEL_ID` gesetzt UND Cookie-Consent erteilt","Meta Standard-Events feuern an korrekten Stellen","CSP-Headers erlauben Meta Pixel Domains","Kein Meta Pixel Code wenn `META_PIXEL_ID` leer (Zero Tracking by Default)","Pixel-ID via `/api/config` geliefert, nie hardcoded im Bundle"],"deps":"- FR-066 (Cookie-Consent-Banner) — Blocker: muss vor Meta-Pixel-Aktivierung implementiert sein\n- FR-063 (Visitor Lifecycle Tracking)","notes":"Zero Tracking by Default: Ohne `META_PIXEL_ID` env var wird kein externes Tracking geladen."},{"id":"FR-065","title":"Flood-Detection und Admin-Alerts","status":"done","priority":"could","entity":"SkillR","gate":"mvp3","problem":"Kein Echtzeit-Monitoring fuer Besucherflutwellen nach Ad-Kampagnen. Admins haben keine Sicht auf Queue-Laenge und Wartezeiten.","solution":"Neuer Admin-Endpunkt `GET /api/analytics/flood-status` mit Concurrent-Visitors, Queue-Length und Flood-Indikator. Konfigurierbar via `FLOOD_THRESHOLD` env var.\n\n### API-Endpunkt\n\n**`GET /api/analytics/flood-status`** (Admin-only)\n```json\n{\n  \"concurrentVisitors\": 87,\n  \"floodThreshold\": 50,\n  \"isFlooding\": true,\n  \"queueLength\": 42,\n  \"avgWaitMs\": 180000,\n  \"activeGeminiSessions\": 10,\n  \"maxGemini","criteria":["`GET /api/analytics/flood-status` gibt Concurrent-Visitors, Queue-Length, Flood-Status","Flood-Threshold konfigurierbar via `FLOOD_THRESHOLD` env var","Admin-Dashboard zeigt Echtzeit-Flood-Indikator","Queue-Wartezeit-Verteilung sichtbar in Admin-Analytics"],"deps":"- FR-062 (Warteraum) — liefert Capacity-Daten\n- FR-063 (Visitor Lifecycle Tracking) — liefert Visitor-Counts","notes":"Admin-only Endpunkt, erfordert Auth + Admin-Rolle."},{"id":"FR-066","title":"Cookie-Consent-Banner, Legal Footer und Pflichtseiten (DSGVO/TMG/TTDSG)","status":"done","priority":"must","entity":"maindset.ACADEMY","gate":"mvp3","problem":"Die Website hat keine rechtlich vorgeschriebenen Pflichtlinks (Impressum, Datenschutzerklaerung, Cookie-Einstellungen). Der Cookie-Banner erfuellt nicht alle TTDSG-Anforderungen (ungleiche Button-Gestaltung, kein Link zur Datenschutzerklaerung, kein Widerrufsmechanismus). Fuer eine deutsche Website mit Zielgruppe 14+ sind folgende Gesetze relevant:\n\n- **TMG §5** — Impressumspflicht\n- **DSGVO Art. ","solution":"### 1. Legal Footer (auf jeder Seite)\n\nWiederverwendbare `LegalFooter`-Komponente mit:\n- Link zu `/impressum`\n- Link zu `/datenschutz`\n- Link zu Cookie-Einstellungen (oeffnet Modal)\n- Copyright-Hinweis\n\nEingebaut in:\n- `WelcomePage.tsx` (ersetzt minimalen Footer)\n- `Layout.tsx` (ersetzt Tagline-Footer)\n\n### 2. Impressum-Seite (`/impressum`)\n\nPflichtangaben nach TMG §5:\n- Vollstaendiger Name / Firm","criteria":["`/impressum` ist von jeder Seite ueber Footer-Link erreichbar","Impressum enthaelt: Name/Firma, Anschrift, Kontakt (E-Mail), Vertretungsberechtigten","Impressum enthaelt Hinweis auf EU-Streitschlichtungsplattform","Impressum laesst sich mit einem Klick aufrufen (max. 2 Klicks von jeder Seite)","`/datenschutz` ist von jeder Seite ueber Footer-Link erreichbar","Datenschutzerklaerung enthaelt alle Art. 13 Pflichtangaben (Verantwortlicher, Zweck, Rechtsgrundlage, Empfaenger, Speicherdauer, Rechte)","Datenschutzerklaerung ist \"in praeziser, transparenter, verstaendlicher und leicht zugaenglicher Form\" (Art. 12)","Jugendgerechte Sprache fuer Zielgruppe 14+","Cookie-Einstellungen sind ueber Footer-Link erreichbar","Widerruf der Cookie-Einwilligung ist mit einem Klick moeglich","Widerruf ist genauso einfach wie die Erteilung (gleichwertige UI)","Nach Widerruf: Marketing-Cookies/Pixel werden deaktiviert","Widerruf wird server-seitig geloggt (Audit Trail, Art. 7 Abs. 1)","Banner zeigt Hinweis fuer 14-15-Jaehrige: Elternbestaetigung empfohlen","Datenschutzerklaerung erklaert Jugendschutz-Massnahmen (Art. 8, JMStV §5)","Banner erscheint beim ersten Besuch, BEVOR Tracking-Cookies gesetzt werden","Zwei Optionen: \"Akzeptieren\" und \"Nur notwendige\" — gleichwertig gestaltet","Keine vorangekreuzten Checkboxen","Meta Pixel NUR nach explizitem \"Akzeptieren\" geladen","Internes First-Party-Analytics ohne PII funktioniert ohne Consent","Banner-Text erklaert Zwecke der Cookies (technisch notwendig vs. Marketing)","Link zur vollstaendigen Datenschutzerklaerung im Banner","Footer ist auf jeder Seite sichtbar (WelcomePage, Layout, Intro-Flow)","Footer enthaelt: Impressum, Datenschutz, Cookie-Einstellungen","Footer enthaelt Copyright-Hinweis mit Jahreszahl","Links sind auch auf mobilen Geraeten gut erreichbar","Kein Text \"Zertifikat\" (Projekt-Regel)","URL-basiertes Routing: /datenschutz und /impressum funktionieren als Direktlinks","SPA-Fallback: Seiten funktionieren auch bei direktem Aufruf (kein 404)","Zurueck-Navigation von Legal-Seiten zur vorherigen Ansicht","Alle bestehenden Tests passen weiterhin","`npm run build` und `npm run build:server` erfolgreich"],"deps":"- Blocker fuer FR-064 (Campaign-Attribution / Meta Pixel)\n- Nutzt bestehende `frontend/services/consent.ts`\n- Nutzt bestehende `docs/legal/privacy-policy.md`","notes":"- **Platzhalter:** Impressum-Daten (Firmenname, Adresse, Kontakt) als Platzhalter, da das Unternehmen noch in Gruendung ist\n- **Datenschutzerklaerung:** Basiert auf dem bestehenden `docs/legal/privacy-policy.md` Text\n- **Kein Cookie-Wall:** Der Banner darf die App-Nutzung nicht blockieren (nur trans"},{"id":"FR-067","title":"Legal Placeholder Management (Admin)","status":"done","priority":"must","entity":"SkillR","gate":"role:admin","problem":"Die Impressum-Seite und Datenschutzerklaerung enthalten Platzhalter fuer Firmendaten, die vor dem Go-Live ausgefuellt werden muessen:\n\n- Firmenname / Inhaber\n- Anschrift (Strasse, PLZ, Ort)\n- Kontakt (E-Mail, Telefon)\n- Vertretungsberechtigte Person\n- Registernummer (Handelsregister / Vereinsregister)\n- USt-IdNr. (gemaess §27a UStG)\n- Verantwortlich fuer Inhalt (§55 Abs. 2 RStV)\n- Datenschutzbeauf","solution":"### 1. Business-Unit-Konfiguration in der Datenbank\n\nNeues DB-Schema `business_config` (PostgreSQL):\n\n```sql\nCREATE TABLE business_config (\n  key         TEXT PRIMARY KEY,\n  value       TEXT NOT NULL,\n  updated_at  TIMESTAMPTZ DEFAULT NOW(),\n  updated_by  TEXT\n);\n```\n\nVorbelegte Keys:\n\n| Key | Beschreibung | TMG/DSGVO |\n|-----|-------------|-----------|\n| `company_name` | Firmenname | TMG §5 |\n| `","criteria":["Admin kann Firmendaten im Admin-Bereich unter \"Geschaeftsdaten\" pflegen","Aenderungen sind sofort live ohne Deployment","`GET /api/config/legal` liefert aktuelle Firmendaten (public, gecached)","`PUT /api/config/legal` erfordert Admin-Auth","Impressum-Seite zeigt DB-Daten statt Platzhalter","Datenschutzerklaerung zeigt DB-Daten fuer \"Verantwortliche Stelle\"","Fallback-Text wenn Felder leer: \"[Bitte im Admin-Bereich konfigurieren]\"","Audit-Log: Letzte Aenderung mit Timestamp und User sichtbar","Alle TMG §5 Pflichtfelder sind im Formular abgedeckt","Validierung: E-Mail-Format, Pflichtfelder markiert","Bestehende Tests passen weiterhin"],"deps":"- FR-066 (Cookie-Consent-Banner, Legal Footer, Pflichtseiten)\n- FR-047 (Management Console)","notes":"- **MVP-Phase:** Platzhalter im Code sind akzeptabel, solange die App nicht oeffentlich ist\n- **Vor Go-Live:** Dieses FR MUSS abgeschlossen sein — TMG §5 Verstoss kann abgemahnt werden\n- **Caching:** `/api/config/legal` kann mit 5min Cache-Control ausgeliefert werden (Impressum aendert sich selten)\n"},{"id":"FR-068","title":"Health Check & Availability Monitoring","status":"done","priority":"should","entity":"SkillR","problem":"After deploying to Cloud Run there is no quick way to verify the live system is healthy. The existing `/api/health` endpoint returns only `{\"status\":\"ok\"}` with no uptime, component latencies, version info, or runtime metrics. Operators have no single-command health overview and no continuous availability tracking.","solution":"### Enhanced health endpoint\n\n- **`GET /api/health`** — unchanged minimal response (`{\"status\":\"ok|degraded\"}`, H14 compliant)\n- **`GET /api/health/detailed?token=<HEALTH_CHECK_TOKEN>`** — returns rich operational data gated by a shared-secret query param:\n  - Service status, git version (build-time SHA via ldflags), started-at timestamp, uptime\n  - Per-component status + latency (PostgreSQL, Redi","criteria":["`GET /api/health` still returns only `{\"status\":\"ok|degraded\"}` (no leak)","`GET /api/health/detailed` without token returns 401","`GET /api/health/detailed?token=<valid>` returns full JSON with version, uptime, components, runtime","`HEALTH_CHECK_TOKEN` read from env, documented in `.env.example`","`make health` shows formatted Cloud Run + health output","`make monitor` polls continuously, Ctrl+C shows summary + writes JSON log","Go binary includes git SHA via ldflags (`version` field in detailed health)","Docker image includes git SHA via build arg","Unit tests cover: public health, token validation, detailed health response structure","Integration test: deploy + `make health` against live service"],"deps":"- TC-025: Security hardening — token-based access pattern\n- FR-013: Web app deployment — Cloud Run infrastructure","notes":"- The health token is a simple shared secret, not user authentication. It protects operational data from public access per H14.\n- The monitor script writes logs to `logs/` (gitignored) for post-incident analysis.\n- Version injection uses Go `ldflags` pattern — no runtime file reads needed."},{"id":"FR-069","title":"GCP Credential Management","status":"done","priority":"must","entity":"SkillR","problem":"The Go backend uses Vertex AI (Gemini) which requires GCP Application Default Credentials (ADC). Currently:\n\n- **Cloud Run:** No service account key is provisioned — AI service fails with \"could not find default credentials\"\n- **Local dev (docker-compose):** Volume-mounted key file works but was set up manually\n- **Deploy scripts:** Pass secrets inline via `--set-env-vars` (visible in `ps aux`, sh","solution":"### Cloud Run: Secret Manager\n\nStore the Vertex AI service account key in **GCP Secret Manager** and mount it as a file volume in Cloud Run using `--set-secrets`:\n\n```\ngcloud run deploy ... \\\n  --set-secrets \"/app/credentials/vertexai-sa.json=vertexai-sa-key:latest\" \\\n  --set-env-vars \"GOOGLE_APPLICATION_CREDENTIALS=/app/credentials/vertexai-sa.json,GCP_PROJECT_ID=...,GCP_REGION=...\"\n```\n\nThis avo","criteria":["`scripts/setup-secrets.sh` stores `credentials/vertexai-sa.json` in Secret Manager","`scripts/deploy.sh` mounts the secret as a file volume via `--set-secrets`","`Makefile` deploy targets pass the same `--set-secrets` flag","`GOOGLE_APPLICATION_CREDENTIALS` is set in both local and Cloud Run environments","`credentials/` directory remains gitignored","AI service initializes successfully on Cloud Run after deploy","`make health` shows AI component as OK after deploy","No service account keys are embedded in Docker images or env vars"],"deps":"- FR-068: Health check — used to verify AI availability after deploy\n- FR-061: Infrastructure supply-chain hardening — aligns with secret management goals\n- TC-025: Security hardening — credential handling pattern","notes":"- Cloud Run's default service account already has some GCP permissions, but Vertex AI requires explicit `roles/aiplatform.user`.\n- The `--set-secrets` flag mounts secrets as files (preferred over env vars for key files).\n- Secret rotation: update the secret version in Secret Manager, then redeploy. "},{"id":"FR-070","title":"Mobile-First Campaign UI Redesign","status":"in-progress","priority":"must","entity":"maindset.ACADEMY","problem":"The current UI was designed desktop-first and is only ~75% responsive. The target audience (14+ youth) primarily uses smartphones for web browsing. Key issues include undersized touch targets, horizontal overflow on narrow viewports, iOS zoom on input focus, and missing safe-area inset support for notched devices. Without a mobile-first approach, the product fails to meet its core audience where t","solution":"Perform a comprehensive mobile-first responsive redesign:\n\n- **Tailwind CDN to npm migration** — Replace the CDN-loaded Tailwind with a proper npm install and build-time compilation for tree-shaking and custom configuration.\n- **Mobile-first responsive redesign** — Rewrite all component styles starting from the smallest breakpoint (375px) and scaling up, rather than the current desktop-down approa","criteria":["All touch targets are >= 44x44px on every interactive element","No horizontal scroll at 375px viewport width","Chat input does not zoom on iOS (font-size >= 16px on all inputs)","Safe-area insets work correctly on iPhone X+ (no content hidden behind notch or home indicator)","PWA \"Add to Home Screen\" works on iOS Safari and Android Chrome","Voice input (FR-011) works on mobile browsers","Coach selection page supports thumb-only navigation","Profile radar chart is readable on small screens (375px width)","Tailwind is installed via npm with build-time compilation (no CDN)"],"deps":"- FR-005 (Gemini Dialogue Engine) — Chat UI must be mobile-optimized\n- FR-009 (Profile Visualization) — Radar chart must be responsive\n- FR-011 (Text/Voice Mode) — Voice input must work on mobile\n- FR-048 (Journey Progress Cards) — Cards must be touch-friendly","notes":"The 14+ target demographic in Germany has a smartphone penetration rate above 95%. Desktop usage among this age group is secondary, primarily for school-related tasks. The mobile experience is not an afterthought — it is the primary experience."},{"id":"FR-071","title":"GCP Terraform Infrastructure as Code","status":"in-progress","priority":"should","entity":"SkillR","problem":"The project currently provisions GCP resources using 4 bash scripts totaling ~1600 lines of imperative shell code. This approach has critical limitations:\n\n- **No state tracking** — There is no record of what has been created, making it impossible to know the current infrastructure state without manual inspection.\n- **No team collaboration** — Multiple developers cannot safely modify infrastructur","solution":"Adopt Terraform with a hybrid approach: Terraform manages base infrastructure declaratively, while bash/Makefile handles the deploy cycle (Docker build, push, and database migrations).\n\n### Terraform Modules\n\nCreate composable Terraform modules for all 13 GCP resources:\n\n| Module              | Resources                                      |\n|---------------------|--------------------------------","criteria":["`terraform init` + `terraform plan` + `terraform apply` provisions a complete staging environment from scratch","`terraform destroy` tears down all managed resources cleanly without orphaned resources","Terraform state is stored in a GCS bucket with versioning and locking enabled","Modules are composable per-environment (staging and production use the same modules with different variables)","`deploy.sh` is updated to a Docker-only workflow (build, push, deploy) that does not duplicate Terraform-managed resources","Sensitive values (database passwords, API keys) are managed via Secret Manager, not stored in Terraform state as plaintext"],"deps":"- FR-013 (Web App Deployment) — Current deployment scripts will be refactored\n- FR-069 (GCP Credential Management) — Terraform must use the same credential patterns","notes":"The migration from bash scripts to Terraform should be incremental. Start by importing existing resources into Terraform state using `terraform import`, then gradually move resource definitions from bash scripts into Terraform modules. At no point should infrastructure be torn down and recreated — t"},{"id":"FR-072","title":"Honeycomb Service Configuration","status":"in-progress","priority":"must","entity":"SkillR","gate":"env:dev","problem":"The backend needs to communicate with the external Honeycomb API (learning journey management) and Memory service (user identity mapping). These services require base URLs and API keys configured via environment variables, following the same pattern as existing GCP/VertexAI configuration.","solution":"Add configuration fields for Honeycomb and Memory service endpoints to the backend config, loaded from environment variables. The services are optional — if not configured, Lernreise routes are not registered.\n\n### Configuration Fields\n\n| Field | Env Var | Required | Description |\n|-------|---------|----------|-------------|\n| `HoneycombURL` | `HONEYCOMB_URL` | No | Base URL of the Honeycomb API |","criteria":["`config.go` includes `HoneycombURL`, `HoneycombAPIKey`, `MemoryServiceURL`, `MemoryServiceAPIKey` fields","Fields loaded from environment variables in `Load()`","`.env.example` documents the new variables with commented-out defaults","Server starts without error when variables are not set (Lernreise features disabled)","No secrets appear in committed code"],"deps":"- TC-028: Lernreise tracking concept","notes":"Authentication uses the `X-API-KEY` header pattern defined in the Honeycomb and Memory OpenAPI specs (`integrations/api-spec/honeycomb-services.yml`, `integrations/api-spec/memory-services.yml`)."},{"id":"FR-073","title":"User Context Synchronization","status":"in-progress","priority":"must","entity":"SkillR","gate":"env:dev","problem":"Honeycomb uses a cross-service identifier (`ctx_id`) that differs from our Firebase UID. On first Lernreise interaction, we must register the user with the Memory service to obtain their `ctx_id`, then cache the mapping locally to avoid repeated lookups.","solution":"Implement a Memory service client that calls `POST /user/access` with the Firebase user's UID, display name, and email. The returned `ctx_id` is stored in a new `honeycomb_ctx_id` column on the `users` table. Subsequent requests use the cached mapping.\n\n### Identity Flow\n\n```\n1. User hits any /api/v1/lernreise/* endpoint\n2. Backend extracts Firebase UID from auth context\n3. Check users.honeycomb_c","criteria":["Memory client implements `POST /user/access` per `memory-services.yml` spec","`X-API-KEY` header sent on all requests","Returned `ctx_id` is cached in PostgreSQL (`users.honeycomb_ctx_id`)","Unit tests with httptest mock server","Ping method for health check integration"],"deps":"- FR-072: Honeycomb service configuration\n- TC-028: Lernreise tracking concept","notes":"The Memory service OpenAPI spec is at `integrations/api-spec/memory-services.yml`. The `UserAccessResponse` schema returns `ctx_id` (string) and `tier` (string)."},{"id":"FR-074","title":"Lernreise Catalog and Selection","status":"in-progress","priority":"must","entity":"maindset.ACADEMY | maindfull.LEARNING","gate":"env:dev","problem":"Users need to browse available learning journeys (Lernreisen) from Honeycomb and select one to start. The backend must proxy the Honeycomb catalog API and manage local instance records that bind a user to a specific course.","solution":"Implement catalog browsing and selection endpoints that proxy Honeycomb's list/data APIs, plus local instance management in PostgreSQL.\n\n### Endpoints\n\n| Route | Method | Description |\n|-------|--------|-------------|\n| `GET /api/v1/lernreise/catalog` | ListCatalog | List available Lernreisen from Honeycomb |\n| `GET /api/v1/lernreise/catalog/:dataId` | GetCatalogDetail | Course detail from Honeyco","criteria":["Honeycomb client implements all 4 Honeycomb API endpoints per `honeycomb-services.yml`","`X-API-KEY` header sent on all Honeycomb requests","Types match OpenAPI schema (HoneycombListEntry, HoneycombData, HoneycombModule, HoneycombModuleTask)","Instance creation stores binding in PostgreSQL","Only one active instance per user at a time","Unit tests with httptest mock server","All endpoints require Firebase authentication"],"deps":"- FR-072: Honeycomb service configuration\n- FR-073: User context synchronization\n- TC-028: Lernreise tracking concept","notes":"Honeycomb API spec at `integrations/api-spec/honeycomb-services.yml`. Types include rich module/task data with localized strings (German labels)."},{"id":"FR-075","title":"Lernprogress Tracking","status":"in-progress","priority":"must","entity":"maindset.ACADEMY | maindfull.LEARNING","gate":"env:dev","problem":"When a user completes tasks within a Lernreise, the backend must submit the completion to Honeycomb, log the progress event locally, and award XP via the engagement system. Users also need to view their progress history.","solution":"Implement task submission and progress tracking endpoints that coordinate between Honeycomb (task state), PostgreSQL (event log), and the engagement system (XP).\n\n### Endpoints\n\n| Route | Method | Description |\n|-------|--------|-------------|\n| `POST /api/v1/lernreise/instances/:id/submit` | SubmitTask | Submit task to Honeycomb, log progress, award XP |\n| `GET /api/v1/lernreise/instances/:id/pro","criteria":["Task submission calls Honeycomb submit endpoint","Progress events logged in `lernreise_progress` table","Instance `progress_percent` and `progress_label` updated from Honeycomb response","XP awarded for task completion, module completion, and course completion","Instance status transitions to \"completed\" when progress reaches 100%","Progress history endpoint returns chronological event list","Unit tests for service logic with mocked dependencies","All endpoints require Firebase authentication"],"deps":"- FR-072: Honeycomb service configuration\n- FR-073: User context synchronization\n- FR-074: Lernreise catalog and selection\n- TC-028: Lernreise tracking concept","notes":"Honeycomb returns the full `HoneycombData` response after task submission, which includes updated `progress_p` and per-module progress. The backend extracts state changes from this response."},{"id":"FR-076","title":"Solid Pod Connection","status":"done","priority":"should","entity":"SkillR","gate":"MVP4","problem":"Users have no visibility into or control over what data the platform stores about them. There is no mechanism for data sovereignty or transparency.","solution":"Allow users to connect a SOLID Pod from their profile page. The Pod acts as a transparency mirror — a user-owned copy of their data that the platform syncs to on demand.\n\n### Architecture\n- App backend (Firestore + PostgreSQL) remains the source of truth\n- Pod receives a one-directional copy (App -> Pod, write-only)\n- No Pod-to-app sync (V2.0 scope)\n- Pod connection is optional — app works normall","criteria":["User can connect a Pod from profile page","Pod connection state persisted in PostgreSQL","App works normally without Pod (graceful degradation)","CSS runs as Docker Compose service alongside app","Connect flow has clear German-language UX with \"digitaler Tresor\" metaphor"],"deps":"- TC-019 (Solid Pod Storage Layer)\n- TC-025 (Security Hardening Phase) — Pod security controls\n- FR-058 (Input Validation) — Pod endpoint validation\n- FR-060 (Rate Limiting) — Pod rate limiting\n- FR-077 (Pod Data Sync)\n- FR-078 (Pod Data Viewer)","notes":"MVP4 scope — no DPoP auth, no automatic sync, no Pod-canonical mode. Those are V2.0."},{"id":"FR-077","title":"Pod Data Sync","status":"done","priority":"should","entity":"SkillR","gate":"MVP4","problem":"Once a Pod is connected, users need a way to push their current app state to the Pod so the transparency mirror stays up to date.","solution":"Provide a manual sync mechanism that serializes 5 entity types from the app backend into Turtle format and writes them to the user's Pod.\n\n### Synced Entities\n| Entity | Pod Path | Source |\n|--------|----------|--------|\n| User Profile | `/profile/state` | PG `users` table |\n| Skill Profile | `/profile/skill-profile` | PG `skill_profiles` table |\n| Journey Progress | `/journey/vuca-state` | Fronte","criteria":["Manual sync pushes 5 entity types to Pod","Data serialized in valid Turtle format with fs: namespace","Partial sync failures handled gracefully","Sync timestamp updated in PostgreSQL","Backend unit tests for serializer validate Turtle output"],"deps":"- FR-076 (Solid Pod Connection)\n- TC-019 (Solid Pod Storage Layer)","notes":"Automatic sync is V2.0 scope. MVP4 is on-demand only (user clicks button)."},{"id":"FR-078","title":"Pod Data Viewer","status":"done","priority":"could","entity":"SkillR","gate":"MVP4","problem":"Users need to see what data has been synced to their Pod in a human-readable format, without needing to navigate the raw Turtle files on the Pod server.","solution":"Provide a Pod data read endpoint and an in-app modal viewer.\n\n### API Endpoint\n- `GET /api/v1/pod/data` — Read Pod contents (human-readable JSON)\n\n### Response Format\n```json\n{\n  \"profile\": {\n    \"state\": \"<turtle content>\",\n    \"skill-profile\": \"<turtle content>\",\n    \"engagement\": \"<turtle content>\"\n  },\n  \"journey\": {\n    \"vuca-state\": \"<turtle content>\"\n  },\n  \"reflections\": []\n}\n```\n\n### Fron","criteria":["`GET /api/v1/pod/data` returns Pod contents in structured JSON","PodManagementCard shows connection status and sync history","Disconnect has confirmation step to prevent accidental disconnection","Eye icon appears on PodManagementCard when pod is connected","Clicking eye icon opens PodDataViewerModal at page level","Modal shows loading state while fetching","Modal displays collapsible Profil / Reise / Reflexionen sections","Empty state shown when pod has no data yet"],"deps":"- FR-076 (Solid Pod Connection)\n- FR-077 (Pod Data Sync)","notes":"The modal is deliberately rendered at the CombinedProfile level (not inside the card) so it can use full-screen overlay sizing independent of the card's layout."},{"id":"FR-079","title":"Sponsor Showrooms","status":"draft","priority":"must","entity":"maindset.ACADEMY | SkillR","gate":"env:dev+plan:enterprise","problem":"maindset.ACADEMY monetarisiert ueber B2B-Sichtbarkeit: Unternehmen sponsern Skills und erhalten Sichtbarkeit durch echte Bildungsexpertise (BC-007 Bildungssponsoring). Die bestehende Codebasis hat keine Multi-Tenant-, Branding- oder Sponsor-Unterstuetzung — sie ist Single-Tenant mit zwei Rollen (`user`, `admin`). Ohne eine konkrete Plattform, auf der Unternehmen ihre Expertise praesentieren koenne"},{"id":"FR-080","title":"Lernreise-Editor (Gestufter Zugang)","status":"draft","priority":"must","entity":"maindset.ACADEMY | maindfull.LEARNING","gate":"env:dev+plan:pro","problem":"Sponsoren sollen Lernreisen erstellen koennen, die ihre Skills mit dem VUCA-Journey-System verknuepfen. Jedoch brauchen verschiedene Tiers unterschiedliche Bearbeitungsmoeglichkeiten: Professional-Sponsoren sollen schnell mit Vorlagen starten koennen, Enterprise-Sponsoren brauchen volle kreative Kontrolle. Der bestehende Meta-Kurs-Editor (FR-045) bietet die Grundlage, muss aber fuer Sponsor-Nutzun"},{"id":"FR-081","title":"Sponsor Analytics Dashboard","status":"draft","priority":"should","entity":"maindset.ACADEMY | SkillR","gate":"env:dev+plan:pro","problem":"Sponsoren brauchen Einblick in die Wirksamkeit ihres Showrooms, um den Wert ihres Abonnements zu verstehen und ihre Inhalte zu optimieren. Gleichzeitig duerfen niemals individuelle Schueler-Daten an Sponsoren weitergegeben werden — das wuerde das Vertrauensmodell (BC-007) zerstoeren."},{"id":"FR-082","title":"Stripe Subscription Management","status":"draft","priority":"must","entity":"SkillR | maindset.ACADEMY","gate":"env:dev+plan:pro","problem":"Das Sponsor-Showroom-Modell (BC-011) benoetigt eine Zahlungsinfrastruktur fuer drei Abo-Tiers (Basic/Professional/Enterprise) mit 30-Tage-Testphase und automatischer Umwandlung. Ohne eine zuverlaessige Zahlungsabwicklung kann das B2B-Geschaeftsmodell nicht aktiviert werden."},{"id":"FR-083","title":"i18n Framework Setup & String Extraction","status":"draft","priority":"must","entity":"SkillR","gate":"closed","problem":"The app has 500+ hardcoded German strings across 30+ components with no internationalization infrastructure. Adding any second language is currently impossible without duplicating the entire frontend.","solution":"Install `react-i18next` with supporting packages, configure the i18n system, extract all hardcoded strings into namespaced JSON translation files, and wrap all user-facing text in translation function calls (`t()`).\n\n### Implementation Steps\n\n1. **Install dependencies:**\n   - `i18next`, `react-i18next`, `i18next-browser-languagedetector`, `i18next-http-backend`\n\n2. **Create i18n configuration:**\n ","criteria":["`react-i18next` installed and initialized with lazy-loading namespace config","All 500+ hardcoded German strings extracted to `locales/de/*.json` files","All 30+ components refactored to use `t()` function calls — zero remaining hardcoded user-facing text","TypeScript types generated for translation keys — `t()` calls are type-checked","All `de-DE` hardcoded locale parameters replaced with dynamic locale","`firebaseErrors.ts` uses translation keys","English translation files `locales/en/*.json` complete for all namespaces","`<html lang>` attribute updates dynamically on language change","Fallback chain works: missing EN key falls back to DE string","App renders identically in German after extraction (no visual regressions)","Unit tests pass with mocked i18n provider","Bundle size increase < 50KB gzipped for i18next + 2 language bundles"],"deps":"- TC-031: Internationalization Architecture (architecture decision)","notes":"- German is the source language. English is the first target.\n- Legal pages (Datenschutz, Impressum) are NOT translated via i18next — they require legally reviewed content per jurisdiction. Only cookie consent UI strings go through i18next.\n- Admin console strings are lower priority but should be ex"},{"id":"FR-084","title":"Multilingual AI Coach Personas","status":"draft","priority":"should","entity":"maindfull.LEARNING","gate":"closed","problem":"The 6 AI coach personas (Susi, Karlshains, Rene, Heiko, Andreas, Cloudia) are defined with hardcoded German system prompts and regional dialects (Kölsch, Schwäbisch, Berlinerisch, Bayerisch, Sächsisch). These prompts are embedded in `coaches.ts` and `introPrompts.ts`. The coaches cannot interact in any language other than German.\n\nFor internationalization, each coach needs equivalent personas that","solution":"### 1. Locale-Aware Coach Data Model\n\nRefactor `coaches.ts` from a static TypeScript constant to a locale-indexed structure loaded from `locales/{locale}/coaches.json`.\n\n```typescript\ninterface CoachPersona {\n  id: string;\n  name: string;\n  tagline: string;\n  description: string;\n  systemPromptFragment: string;  // locale-specific system prompt\n  dialect: string;               // locale-specific s","criteria":["Coach personas loaded from `locales/{locale}/coaches.json` instead of hardcoded constants","English coach personas written with equivalent personality but culturally adapted expression","`introPrompts.ts` accepts `locale` parameter for all prompt-building functions","Gemini API calls include explicit language instruction","Interest extraction keywords defined per locale","German coach experience unchanged (no regression)","English coach conversations feel natural, not translated","`[SMALLTALK_DONE]` and other prompt markers work language-independently","Unit tests for prompt building cover DE and EN locales","Integration test: full intro chat in English produces valid interest extraction"],"deps":"- FR-083: i18n Framework Setup & String Extraction (i18next must be available)\n- TC-031: Internationalization Architecture\n- TC-023: Chat Dialog Architecture","notes":"- German dialect coaches (Kölsch, Schwäbisch, etc.) are a **product differentiator** for the German market. They should not be removed or flattened — they remain the German-locale experience.\n- English coaches should have distinct voice/personality but cannot rely on English dialect humor (Cockney, "},{"id":"FR-085","title":"Language Selection UI & Locale Persistence","status":"draft","priority":"must","entity":"maindset.ACADEMY","gate":"closed","problem":"There is no mechanism for users to select their preferred language. The app has no language detection, no locale context provider, and no persistence of language preference. When i18n support lands (FR-083), users need a way to discover and switch languages.","solution":"### 1. Language Selector Component\n\nA compact language selector in the app header (Layout.tsx), positioned next to the profile/logout controls.\n\n**Design:**\n- Globe icon button that opens a dropdown\n- Each language shown in its own name: \"Deutsch\", \"English\", \"Français\" (not \"German\", \"English\", \"French\")\n- Current language highlighted\n- Compact on mobile (icon only, dropdown on tap)\n- No page rel","criteria":["Language selector component renders in Layout header on all pages","Available languages: German (de), English (en) for Phase 1","Language names displayed in their own script (\"Deutsch\", \"English\")","Switching language re-renders UI instantly without page reload","Selection persisted to localStorage immediately","Selection synced to Firebase `preferredLocale` for authenticated users","On fresh visit, language detected from localStorage → browser → `de`","`?lang=en` URL parameter overrides detection (one-time, then persisted)","`<html lang>` attribute updates on language change","Language selector accessible via keyboard and screen reader","Mobile: compact icon-only trigger with dropdown","Desktop: icon + current language name with dropdown","WelcomePage and LoginPage show language selector before auth"],"deps":"- FR-083: i18n Framework Setup & String Extraction\n- TC-031: Internationalization Architecture","notes":"- Do not add language flags (country flags) as language indicators — flags represent countries, not languages (e.g., Portuguese is spoken in Portugal and Brazil, Spanish in Spain and 20+ countries). Use language names in their own script instead.\n- The language selector should be subtle, not promine"},{"id":"FR-086","title":"Partner Branding System","status":"done","priority":"should","problem":"All brand text (name, taglines, copyright, contact emails, logos) was hardcoded across ~15 frontend components. Partners and sponsors need branded showrooms at `{slug}.maindset.academy` subdomains without code changes per TC-030.","solution":"Runtime branding system with:\n- `BrandConfig` type with 16 brandable tokens\n- `BrandProvider` React context with `useBrand()` hook\n- Subdomain-based tenant resolution\n- Brand CRUD API (`/api/brand/:slug`)\n- SQLite storage for brand configs\n- Admin UI (BrandConfigEditor) in Management Console\n- CSS custom properties for theme colors\n- AI prompt parameterization for per-brand coach identity","criteria":["BrandConfig interface defined with all 16 tokens","Default brand constants file with Future SkillR defaults","Subdomain resolution: `{slug}.maindset.academy` in production, `?sponsor=slug` in dev","BrandProvider wraps App, resolves brand on mount","CSS custom properties `--brand-primary` and `--brand-accent` set at runtime","Brand CRUD API: GET public, POST/PUT/DELETE admin-only","SQLite `brand_configs` table created on startup","All 11 components migrated from hardcoded text to `useBrand()`","`prompts.ts` converted to parameterized functions","BrandConfigEditor with WCAG contrast preview in admin console","Sponsor label (\"Supported by ...\") in footer for partner brands","Default brand loads unchanged when no partner slug present"],"deps":"- TC-034: Partner Branding System (architecture decision)\n- TC-030: Multi-Tenant Showrooms (specifies subdomain approach)\n- BC-011: Sponsor Showrooms (business concept)","notes":"### Files Created\n- `frontend/types/brand.ts` — BrandConfig interface\n- `frontend/constants/defaultBrand.ts` — DEFAULT_BRAND\n- `frontend/services/tenant.ts` — subdomain slug resolution\n- `frontend/contexts/BrandContext.tsx` — BrandProvider + useBrand()\n- `frontend/server/routes/brand.ts` — CRUD API\n"},{"id":"FR-087","title":"PodProxy Federation Layer","status":"draft","priority":"should","entity":"SkillR","problem":"Users who already have a Solid Pod (e.g., on solidcommunity.net, Inrupt Pod Spaces, or self-hosted CSS instances) cannot use their existing Pod with SkillR. The current implementation only supports managed Pods (hosted by SkillR). This creates two problems:\n\n1. **Data fragmentation:** Users with existing Pods must maintain a separate SkillR-managed Pod alongside their personal Pod. Their SkillR pr","solution":"Implement a PodProxy component (`backend/internal/solid/server/proxy.go`) within the custom Solid Pod server (FR-086). The PodProxy operates as a transparent forwarding layer that:\n\n1. **Translates internal Pod paths to external Pod URLs** — A request to `/pods/alice/profile/card` is forwarded to `https://solidcommunity.net/alice/profile/card` if Alice uses an external Pod.\n2. **Manages authentica","criteria":["PodProxy forwards GET, HEAD, PUT, POST, DELETE to external Pods","PodProxy rewrites internal paths to external Pod URLs correctly","DPoP proof generation for external Pod authentication","OAuth2 token storage in GCP Secret Manager (not in database)","Automatic token refresh on 401 responses from external Pods","BYOP connection flow: discover OIDC issuer, authorize, store tokens","BYOP disconnection: revoke tokens, clear references, update pod_provider","Read caching with configurable TTL (default: 60s)","Cache invalidation on write-through (PUT/POST/DELETE invalidate affected paths)","502 response with SkillR error body when external Pod is unavailable","Stale cache serving with `Warning` header when Pod is temporarily down","Pod migration: managed → external (copy resources, update provider)","Pod migration: external → managed (copy accessible data, provision managed Pod)","Migration progress tracking (partial migration resume)","SSRF prevention on external Pod URLs (block private networks, metadata endpoints)","Admin console: list users by Pod provider, show proxy error rates","Unit tests for: path rewriting, DPoP proof generation, cache logic, error handling","Integration tests for: BYOP flow (mock external Pod), migration, proxy forwarding"],"deps":"- [TC-032](../arch/TC-032-custom-solid-pod-server.md) — Architecture concept\n- [FR-086](FR-086-custom-solid-pod-server.md) — Custom Solid Pod Server (prerequisite)\n- [FR-076](FR-076-solid-pod-connection.md) — Pod connection (updated for BYOP)\n- [FR-056](FR-056-server-auth-session-management.md) — Se","notes":"- Solid-OIDC specification: https://solidproject.org/TR/oidc (v0.1.0)\n- DPoP specification: RFC 9449\n- The PodProxy must handle content negotiation — external Pods may return JSON-LD where SkillR expects Turtle. The proxy should request `Accept: text/turtle` explicitly.\n- External Pod providers know"},{"id":"FR-088","title":"SkillR Profile Pod Storage","status":"draft","priority":"must","entity":"SkillR","problem":"Today, the SkillR skill profile exists only in platform-controlled storage (Firestore + PostgreSQL). Users have no sovereign ownership of their most valuable asset — their skill profile. The MVP4 Pod sync (FR-077) writes a copy to the Pod, but:\n\n1. **The app remains source of truth** — The Pod version is a secondary mirror, not canonical.\n2. **No bidirectional sync** — Changes made directly on the","solution":"Evolve the Pod integration from \"transparency mirror\" (app-primary) to \"Pod-canonical\" (Pod-primary) for the SkillR skill profile and related entities.\n\n### Pod-Canonical Architecture\n\n```\nBefore (MVP4):           After (FR-088):\nApp → Pod (copy)          Pod ← → App (canonical)\nApp = source of truth     Pod = source of truth\nManual sync               Event-driven sync\nWrite-only                Bi","criteria":["SkillProfile write to Pod triggered automatically on profile recomputation","InterestProfile write to Pod triggered automatically on interest update","VucaState write to Pod triggered on station completion","EngagementState write to Pod triggered on XP/streak change","ReflectionResult write to Pod triggered on reflection submission","Async Firestore mirror update after Pod write (non-blocking)","Async PostgreSQL index update after Pod write (non-blocking)","Profile read from Pod as primary source (with Firestore fallback)","X-Data-Source response header indicates \"pod\" or \"cache\"","ETag-based change detection for bidirectional sync","Reconciliation job: on-demand (profile page load) + periodic (15-min for active users)","Vocabulary validation on managed Pod writes (reject invalid, return 422)","Advisory validation on PodProxy writes (log warning, allow write)","Profile export endpoint: GET /api/v1/pod/export returns ZIP archive","Export contains Turtle files for all profile entities + README + metadata","Export is importable on another Solid server (self-contained, no external references)","Sync state tracking: last sync timestamp, version vector per entity","Conflict resolution: Pod wins for profile data, log conflicts","Frontend: profile page shows data source indicator (Pod vs cache)","Frontend: Pod data viewer shows last sync time and entity-level status","Unit tests for: event-driven sync, vocabulary validation, export generation, reconciliation","Integration tests for: write round-trip (event → Pod → Firestore), bidirectional sync, export/import"],"deps":"- [TC-032](../arch/TC-032-custom-solid-pod-server.md) — Custom Solid Pod Server architecture\n- [TC-019](../arch/TC-019-solid-pod-storage-layer.md) — Four-tier storage model (Tier S canonical)\n- [FR-086](FR-086-custom-solid-pod-server.md) — Custom Solid Pod Server (prerequisite)\n- [FR-087](FR-087-pod","notes":"- The `fs:` namespace vocabulary is defined in TC-019: `https://vocab.maindset.academy/ns/`\n- FR-077 (Pod Data Sync) is not superseded entirely — it continues to handle manual sync for non-profile entities (engagement, journey). FR-088 specifically makes the **profile** Pod-canonical with automatic "},{"id":"FR-089","title":"Lernreise Content CLI Tool (`lrtool`)","status":"draft","priority":"must","entity":"SkillR","problem":"Lernreise content (courses, modules, tasks) is currently authored and managed via the Python-based `hoc-stage` CLI. This tool lives in a separate repository, uses a different language (Python) than the maindfull.LEARNING engine (Go), and cannot be directly integrated into the platform. Content authors need a Go-native CLI that can be distributed as a single binary and shares data models with the m","solution":"Build `lrtool`, a Go CLI using the Cobra framework, that provides the `composer` and `coach` command groups from hoc-stage:\n\n### Composer Commands (Content Authoring)\n\n| Command | Description | Source |\n|---------|------------|--------|\n| `lrtool composer init` | Initialize `learning_paths/` directory structure | hoc-stage composer init |\n| `lrtool composer validate` | Validate content against Go ","criteria":["`lrtool composer init` creates the `learning_paths/` directory structure","`lrtool composer validate` validates all courses/modules/tasks against Go struct schemas","Validation detects: missing required fields, duplicate IDs, broken dependency links, cycles","`lrtool composer build` produces `publication.json` identical to hoc-stage output","`lrtool composer tree` displays a text-based dependency tree with cycle warnings","`lrtool coach publish --dry-run` shows what would be uploaded without writing","`lrtool coach publish` uploads to Firestore `lernpfad_template` collection","Reads the same YAML+MD format as hoc-stage (backward compatible)","Distributed as a single binary (no Python runtime needed)","Unit tests for all parsing, validation, and build logic"],"deps":"- TC-033: Existing Systems Inventory\n- TC-034: Backend Toolset Migration Strategy\n- FR-074: Lernreise Catalog Selection (data model alignment)","notes":"- Cobra framework for CLI structure (used by kubectl, gh, docker)\n- `gopkg.in/yaml.v3` for YAML parsing\n- `github.com/yuin/goldmark` for Markdown frontmatter parsing\n- Go `gonum/graph` or custom implementation for dependency graphs\n- Firebase Admin Go SDK for Firestore operations"},{"id":"FR-090","title":"ER1 Synchronization Service","status":"draft","priority":"must","problem":"The Erinnerungsraum (Memory Space) synchronization currently runs via the Python-based CTM tool (`confluent_topic_manager`). It syncs multimodal items (text, audio, images) from an external Memory Space API into local SQLite storage. This needs to be reimplemented in Go as part of the maindfull.LEARNING engine and provide both CLI and API access.","solution":"Build a Go-based ER1 synchronization service in `backend/internal/memory/` that replicates the CTM memory-space command group:\n\n### CLI Commands (`lrtool memory`)\n\n| Command | Description | Source (CTM) |\n|---------|------------|-------------|\n| `lrtool memory add` | Configure Memory Space link (URL + context + tags) | `memory-space add` |\n| `lrtool memory sync` | Sync items incrementally | `memor","criteria":["`lrtool memory add --url <URL> --user-context <CTX>` configures a link","`lrtool memory sync` downloads new items since last sync","`lrtool memory sync --force` re-downloads all items","`lrtool memory sync --limit N` limits batch size","Audio and image media downloaded for tagged items","Deleted items tracked (not hard-deleted from local store)","Operation log records every sync (timestamp, count, status)","`lrtool memory view --today` filters items by creation date","`lrtool memory ping` returns API health status","All sync logic has unit tests with mock HTTP server","Integration test against a real Memory Space API endpoint"],"deps":"- TC-033: Existing Systems Inventory (CTM analysis)\n- TC-034: Backend Toolset Migration Strategy","notes":"- SQLite via `modernc.org/sqlite` (pure Go, no CGO required)\n- HTTP client with retries and timeout configuration\n- Auth via `X-API-KEY` header (matching CTM protocol)\n- Consider bbolt as alternative to SQLite for simpler key-value patterns\n- Sync should be idempotent and resumable after failure"},{"id":"FR-091","title":"AI Candidate Generation Service","status":"draft","priority":"should","problem":"The hoc-stage Python tool provides LLM-powered task candidate generation: trainers write a draft description, the system retrieves semantically similar content via RAG, and an LLM generates structured task suggestions. This workflow needs to be available in Go as part of the maindfull.LEARNING engine.","solution":"Implement an AI candidate generation pipeline in `backend/internal/aitools/`:\n\n### Workflow\n\n```\n1. Trainer provides draft text (e.g., \"Create a task about networking basics\")\n2. Generate embedding for draft via external API (OpenAI embeddings endpoint)\n3. Search vector index for semantically similar existing modules/tasks\n4. Construct LLM prompt with draft + retrieved context\n5. Call LLM (OpenAI-","criteria":["`lrtool llm build-index` indexes all tasks/modules into vector store","`lrtool llm suggest-task` generates a structured candidate from draft text","Candidates include: suggested module, task title, description, confidence score","`lrtool llm accept` creates a new task markdown file in the correct module","`lrtool llm reject` records the reason for future prompt tuning","All LLM calls logged with prompt, response, and token usage","Works with any OpenAI-compatible API endpoint (configurable)"],"deps":"- FR-089: Lernreise Content CLI Tool (content access)\n- TC-034: Backend Toolset Migration Strategy","notes":"- Embedding via OpenAI API (`text-embedding-ada-002` or newer)\n- Vector search via LanceDB Go bindings or external service\n- LLM prompt templates stored as markdown files in `prompts/` directory\n- Consider caching embeddings to avoid redundant API calls"},{"id":"FR-092","title":"Memory Insights Processor","status":"draft","priority":"should","problem":"The CTM tool provides an insights processor that batch-scans synchronized memory items using LLM to extract actionable content (email drafts, feature requests, decisions, tasks). This capability needs to be available in the Go toolset for automated processing of Erinnerungsraum content.","solution":"Implement an insights extraction pipeline in `backend/internal/memory/insights.go`:\n\n### Workflow\n\n```\n1. Load synchronized memory items from local store\n2. For each item (or batch):\n   a. Construct LLM prompt with item content\n   b. Call LLM for structured classification\n   c. Parse response into ActionItem structs\n3. Compare with existing action items (change detection)\n4. Store/update action it","criteria":["`lrtool memory insights scan` processes all unscanned items","Each item classified into one or more action types","Change detection compares new vs. existing insights","Version history maintained for all action items","`lrtool memory insights view` displays formatted output (table)","`--force` flag re-processes already-scanned items","`--type` flag filters by action type","LLM calls audited (prompt, response, tokens)","Unit tests with mock LLM responses"],"deps":"- FR-090: ER1 Synchronization Service (provides synced items)\n- TC-034: Backend Toolset Migration Strategy","notes":"- Batch processing to minimize LLM API calls\n- Configurable LLM model per insight type (e.g., cheaper model for classification)\n- Consider parallel processing with Go goroutines for large item sets"},{"id":"FR-093","title":"Lernreise REST API Endpoints","status":"draft","priority":"must","problem":"The hoc-stage Python tool exposes a FastAPI-based REST API for course/module/task CRUD. The maindfull.LEARNING engine (Go/Echo) needs equivalent endpoints so that the maindset.ACADEMY frontend and admin console can manage Lernreise content programmatically without depending on a separate Python service.","solution":"Add Lernreise management endpoints to the maindfull.LEARNING engine in `backend/internal/lernreise/handler.go`, integrated into the existing Echo router.\n\n### API Endpoints\n\n```\n# Courses\nGET    /api/v1/lernreise/courses                    — List all courses\nGET    /api/v1/lernreise/courses/:courseId            — Get course details\nPOST   /api/v1/lernreise/courses                     — Create cour","criteria":["All CRUD endpoints implemented for courses, modules, tasks","Endpoints use shared Go models from `lernreise/models.go`","Publish endpoint writes to Firestore `lernpfad_template` collection","Validate endpoint runs all validation rules and returns errors","Auth middleware enforces role-based access","Memory endpoints trigger sync and return insights","Request/response validation with proper HTTP status codes","Unit tests for all handlers with mock dependencies","Integration tests for Firestore publish flow"],"deps":"- FR-089: Lernreise Content CLI Tool (shared models and logic)\n- FR-090: ER1 Synchronization Service (memory endpoints)\n- FR-092: Memory Insights Processor (insights endpoints)","notes":"- Reuse existing Echo middleware (auth, rate limiting, logging)\n- Follow existing maindfull.LEARNING API patterns (see `backend/internal/ai/handler.go`)\n- OpenAPI spec to be generated from Go structs\n- Consider pagination for list endpoints"},{"id":"FR-094","title":"Report Generation Pipeline","status":"draft","priority":"could","problem":"The CTM tool generates automated reports (weekly sprint journals, daily reviews, monthly retrospectives) from synchronized memory items using LLM-powered summarization and clustering. This capability supports trainers and administrators in tracking learning progress and extracting knowledge from accumulated Erinnerungsraum content.","solution":"Implement a Go-based report generation pipeline in `backend/internal/memory/journal.go`:\n\n### Report Types\n\n| Type | Frequency | Source (CTM) | Description |\n|------|-----------|-------------|-------------|\n| Weekly Journal | Weekly | `journal_config.yaml` | Sprint summary with clusters and narratives |\n| Daily Review | Daily | `daily_journal_config.yaml` | Day's activity summary |\n| Monthly Repor","criteria":["Weekly journal generated from items in a given ISO week","Daily review generated from items on a given date","Monthly report generated from items in a given month","Reports include: item count, clusters, summaries, narrative","HTML output rendered via Go templates","`--distribute` sends email to configured recipients","`--gdrive` uploads HTML to Google Drive folder","`--dry-run` shows report preview without side effects","Configuration loaded from YAML file","Unit tests for data loading, rendering (mock LLM for clustering/summarization)"],"deps":"- FR-090: ER1 Synchronization Service (provides synced items)\n- FR-092: Memory Insights Processor (can enrich reports with insights)","notes":"- Go `html/template` for HTML rendering (no external dependency)\n- PDF generation can be deferred (HTML-only for MVP)\n- Google Drive via `google.golang.org/api/drive/v3`\n- Gmail via `google.golang.org/api/gmail/v1`\n- Consider Go cron library for scheduled generation (e.g., `robfig/cron`)\n- Report te"},{"id":"FR-095","title":"Custom Solid Pod Server (Go)","status":"draft","priority":"must","entity":"SkillR","problem":"The current Pod implementation (MVP4) depends on Community Solid Server (CSS) v7 — a Node.js reference implementation running as a separate Docker Compose service. This creates:\n\n1. **Dual-runtime complexity:** Go backend + Node.js CSS in separate containers. Two Docker images, two runtimes, two dependency trees.\n2. **Limited auth integration:** Firebase JWT → Pod access requires a middleware brid","solution":"Implement a custom Solid Pod server in Go as a package within the existing backend (`backend/internal/solid/server/`). The server implements the Solid Protocol v0.11.0 (©2019–2025 Inrupt Inc. and imec, https://solidproject.org/TR/protocol) with the following components:\n\n### Core Components\n\n| Component | File | Responsibility |\n|-----------|------|---------------|\n| **LDP Handler** | `ldp.go` | H","criteria":["LDP Handler supports GET, HEAD, OPTIONS, PUT, POST, DELETE for RDF resources","Container creation with `ldp:contains` triples in listing response","PUT to nested path auto-creates intermediate containers","POST to container creates resource with server-assigned URI (UUID-based)","Slug header hint respected for POST resource naming","Content-Type required on PUT/POST/PATCH — 400 if missing","DELETE on non-empty container returns 409","DELETE on root container returns 405","WAC engine parses ACL Turtle and evaluates access modes (Read, Write, Append, Control)","ACL inheritance: resource → parent container → ... → root container","WAC-Allow header included in responses","Link header with `rel=\"acl\"` pointing to ACL resource","Link header with `rel=\"type\"` for LDP container/resource types","CORS headers set per Solid Protocol requirements","Slash-semantics: `/path` vs `/path/` handled with 301 redirect","WebID Profile Document served at `/{username}/profile/card`","Pod provisioning creates root container + profile directory + default ACLs","PostgreSQL store correctly handles CRUD with ETag generation","Firebase JWT → WebID auth bridge works for all LDP operations","CSS Docker Compose service removed from `docker-compose.yml`","Unit tests for: LDP operations, WAC evaluation, Turtle parsing, container listing","Integration tests for: full resource lifecycle, ACL enforcement, WebID resolution","Solid Conformance Test Harness passes for implemented requirements"],"deps":"- [TC-032](../arch/TC-032-custom-solid-pod-server.md) — Architecture concept\n- [TC-019](../arch/TC-019-solid-pod-storage-layer.md) — Storage layer architecture\n- [FR-076](FR-076-solid-pod-connection.md) — Pod connection (existing, updated)\n- [FR-077](FR-077-pod-data-sync.md) — Pod data sync (existin","notes":"- Renumbered from FR-086 to FR-095 to resolve number collision with FR-086 (Partner Branding).\n- Solid Protocol specification: https://solidproject.org/TR/protocol (v0.11.0)\n- Web Access Control specification: https://solidproject.org/TR/wac (v1.0.0)\n- Go RDF/Turtle library candidates: `github.com/d"},{"id":"FR-096","title":"Test Coverage Hardening","status":"done","priority":"should","problem":"Daily audit (2026-02-23) found 35% backend unit test coverage, 0% React component tests,\nand missing tests for security-critical middleware (rate limiting, Firebase auth wiring).","solution":"Add targeted tests for security middleware and critical integration points.","criteria":["Unit test for RateLimit middleware (in-memory fallback path)","Unit test for RateLimit middleware (Redis path)","Integration test: FirebaseAuth middleware rejects invalid tokens","Integration test: CSP header present on all responses","Unit test for RateLimiter.SetClient upgrade path","Test for credentials/ directory not tracked by git"],"deps":"- FR-056 (auth middleware must be wired)\n- FR-060 (rate limiters must be wired)"},{"id":"FR-111","title":"Frontend Passive Rendering — No Active Components","status":"specified","priority":"must","problem":"The frontend must be a pure rendering layer. Currently, some components contain business logic, data fetching, state transformations, or validation that should live in the Go backend. All data, configuration, coach personas, and content must be served by the Go backend API — the frontend should only render what the backend provides.\n\nThis ensures:\n- Single source of truth (backend)\n- Easier testin","solution":"Enforce the following architectural rule across the entire frontend:\n\n1. **No business logic in components** — Components receive data via props or API responses and render it. No computation, filtering, sorting, or transformation of domain data in the frontend.\n2. **No hardcoded content** — All user-facing text, coach personas, journey definitions, station content, and configuration must come fro","criteria":["All coach persona data (names, taglines, dialects, settings, colors, system prompts) is served by a backend API endpoint, not hardcoded in frontend constants","All user-facing German text that is content (not UI chrome) comes from the backend","No domain business logic exists in frontend components","Frontend components are pure rendering functions of their props + API data","The Express gateway (`frontend/server/`) is eliminated or reduced to a dev-only proxy"],"deps":"- Go backend must expose all necessary API endpoints before frontend constants can be removed\n- FR-096 (test coverage) should verify the boundary","notes":"- UI-level state (modal open/closed, scroll position, animation state) is fine in the frontend — this rule applies to **domain data and business logic** only.\n- The `coaches.ts` constants file is a prime example of data that should come from the backend.\n- This is a gradual migration: new features m"},{"id":"FR-112","title":"EU Co-Funding Notice","status":"in-progress","priority":"must","problem":"The project is co-financed by the European Union under the programme \"Zukunftsplattform fuer soziale Innovationen und Modellvorhaben\". EU co-funding regulations require a visible co-funding notice and the official EU co-funded logo on all public-facing pages.","solution":"Display the following text prominently on all landing pages:\n\n> Das Projekt wird im Rahmen des Programms \"Zukunftsplattform fuer soziale Innovationen und Modellvorhaben\" mit einer Zuwendung in Hoehe von 95 % der zuwendungsfaehigen Ausgaben durch die Europaeische Union kofinanziert.\n\nAdditionally, display the official \"Kofinanziert von der Europaeischen Union\" logo (EU flag + text, NEG variant for ","criteria":["Co-funding text is displayed below the top navigation on WelcomePage","Co-funding text is displayed in the WelcomePage footer","Co-funding text is displayed in the LegalFooter component (both full and compact variants)","EU co-funded logo (NEG variant) accompanies the text in all placements","Logo is readable and appropriately sized on both mobile and desktop","Text and logo are centered","Logo alt text is descriptive for accessibility"],"deps":"- None","notes":"- The co-funding percentage (95%) and programme name must appear exactly as specified.\n- The NEG logo variant must be used on dark backgrounds; if a light-background page is added later, the POS variant should be used instead.\n- This is a legal/compliance requirement, not a design choice — it must r"},{"id":"FR-113","title":"Meta Ad Campaign Tracking","status":"in-progress","priority":"must","problem":"The project has existing but dead campaign infrastructure: `captureUTM()` in `campaignAttribution.ts` and Meta Pixel events in `metaPixel.ts` are never called. UTM params are never merged into analytics events. There is no way for an admin to define campaigns or see their performance.","solution":"1. **Activate UTM capture** — Call `captureUTM()` on App mount so URL parameters are stored in sessionStorage\n2. **Merge UTM into analytics** — Spread stored UTM params into every analytics event's `properties`\n3. **Activate Meta Pixel** — Initialize pixel after marketing consent, fire lifecycle events (ViewContent, InitiateCheckout, CompleteRegistration)\n4. **Campaign management** — New `campaign","criteria":["Opening `/?utm_source=meta&utm_campaign=test1` stores UTM params in sessionStorage","All analytics events include UTM params in their properties when present","Meta Pixel loads only after marketing consent is granted","Pixel fires ViewContent on coach select, InitiateCheckout on intro start, CompleteRegistration on login","Admin can create, edit, and archive campaigns via Kampagnen tab","Campaign form auto-generates UTM link with copy button","Stats view shows visitor count, registration count, cost-per-visitor, cost-per-registration, and funnel","`npx tsc --noEmit` passes with zero new errors"],"deps":"- FR-064 (Campaign Attribution & Meta Pixel — dead code that this FR activates)\n- FR-066 (Cookie Consent — consent gating for pixel)\n- FR-050 (User Behavior Tracking — analytics event infrastructure)","notes":"- Campaign URLs use the pattern `https://skillr.app?utm_source=...&utm_campaign=...`\n- Stats are derived from existing `user_events` table via `json_extract` on the `properties` JSONB column\n- Soft-delete pattern: campaigns are archived (status='archived'), never hard-deleted"},{"id":"FR-114","title":"Migrate to Unified Google GenAI Go SDK","status":"draft","priority":"should","problem":"The Go backend uses two Google AI SDKs simultaneously:\n\n| SDK | Package | Used For | Status |\n|-----|---------|----------|--------|\n| Classic Vertex AI | `cloud.google.com/go/vertexai/genai` | Chat, Generate, Ping | **Deprecated** (removal: 2026-06-24) |\n| Unified GenAI | `google.golang.org/genai` | TTS, STT | Current |\n\nGoogle deprecated the classic SDK on 2025-06-24 with a 12-month removal windo","solution":"Migrate all AI calls from `cloud.google.com/go/vertexai/genai` to `google.golang.org/genai` (the unified SDK already used for TTS/STT). After migration, remove the classic SDK dependency entirely.\n\n### Scope\n\n| Method | Current SDK | Target SDK | Notes |\n|--------|------------|------------|-------|\n| `Chat()` | classic `genai.Client` | unified `ugenai.Client` | System instructions, safety settings","criteria":["All `Chat()`, `Generate()`, `Ping()` calls use `google.golang.org/genai`","`cloud.google.com/go/vertexai/genai` removed from `go.mod`","Deprecation warning no longer appears in startup logs","JMStV safety settings preserved (youth protection)","All existing unit tests pass","Integration tests pass (`make e2e-TTS-VertexAI`)","No behavior change for end users"],"deps":"- TC-018 (Agentic Backend VertexAI — architecture)\n- TC-035 (TTS Region Separation — unified SDK already used for TTS)\n- FR-010 (AI Coach Voice — TTS dialect support)","notes":"- **Deadline:** The classic SDK is removed 2026-06-24. This migration must complete before then.\n- The unified SDK supports both `BackendVertexAI` and `BackendGoogleAI`, which may simplify future multi-backend support.\n- Consider whether Chat/Generate need their own region (`europe-west3`) separate "},{"id":"FR-115","title":"Dev Admin Seed Defaults","status":"done","priority":"should","problem":"When starting the backend locally for the first time, developers must manually set `ADMIN_SEED_EMAIL` and `ADMIN_SEED_PASSWORD` env vars before they can log in to the admin panel. If neither is set, `SeedAdmin` silently skips — leaving the app without any admin user and no indication of what went wrong. Even when seeding succeeds, the credentials are not visible in the startup logs, forcing develo","solution":"1. Add `AdminSeedEmail` and `AdminSeedPassword` to `Config` with dev defaults (`admin@skillr.local` / `Skillr1dev`).\n2. Show both values in the `=== Configuration Status ===` log block so they are always visible at startup.\n3. `SeedAdmin` receives credentials from config (single source of truth) and logs them when a new admin is actually created.\n\n### Startup log output\n\n```\n=== Configuration Stat","criteria":["`Config` has `AdminSeedEmail` / `AdminSeedPassword` with dev defaults","`LogStatus()` prints admin email and password in the configuration block","`SeedAdmin` reads credentials from config (not directly from env)","Default password passes existing password strength validation (8+ chars, upper + lower + digit)","Env vars `ADMIN_SEED_EMAIL` / `ADMIN_SEED_PASSWORD` override the defaults","Seeding skipped when users table is non-empty","Go build passes, no test regressions"],"deps":"- FR-057 (Admin Access Control Hardening) — admin seed mechanism","notes":"- The default password `Skillr1dev` satisfies the M20 password policy (uppercase S, lowercase killrdev, digit 1).\n- In production, `ADMIN_SEED_EMAIL` / `ADMIN_SEED_PASSWORD` should always be set explicitly via Secret Manager or env config. The defaults are intended for local development only."},{"id":"FR-116","title":"Lernreise Content Pack","status":"in-progress","priority":"must","problem":"The globe view shows only 3 abstract journey types with single station markers. Users need concrete, themed Lernreisen as hands-on experiences at real-world locations to make the Reise nach VUCA tangible and engaging for 14+ youth.","solution":"1. Add 10 default Lernreisen as a \"Content Pack\" — each with a real-world location, narrative setting, and local guide character.\n2. Center the journey carousel cards (currently left-aligned horizontal scroll).\n3. Serve the content pack via backend API (`GET /api/v1/content-pack`) with PostgreSQL storage.\n4. Frontend fetches from API with fallback to hardcoded defaults.","criteria":["Journey cards are centered in the carousel","10 Lernreise cards render after the 3 journey type cards","Each Lernreise card shows location badge and parent journey color","Clicking a Lernreise card flies the globe to its coordinates","13 total markers visible on the globe (3 original + 10 new)","Backend serves `GET /api/v1/content-pack` with 10 Lernreisen from PostgreSQL","Frontend falls back to hardcoded constants if API unavailable","Go backend builds and tests pass","Frontend type-check passes"],"deps":"- FR-074: Lernreise catalog (existing journey framework)\n- FR-075: Lernreise instances","notes":"Each Lernreise maps to one of the 3 journey types for color coding:\n- **vuca** (blue): Lachs angeln, Baeume faellen, Schneemobil fahren, Einbaum segeln\n- **entrepreneur** (orange): Loeten, Gold finden, Boot bauen\n- **self-learning** (purple): Kleider naehen, Rehkitz pflegen, Wildpferde reiten"},{"id":"FR-117","title":"Console Error Cleanup — Unauthenticated API Calls & Direct SDK Usage","status":"in-progress","priority":"should","problem":"The browser console during the VUCA onboarding chat shows three categories of errors that confuse developers and mask real issues:\n\n1. **`POST /api/sessions 405 (Method Not Allowed)`** — `db.ts` fires session-logging calls without auth headers during the unauthenticated intro flow. The backend requires `FirebaseAuthMiddleware`.\n2. **`POST /api/prompt-logs 401 (Unauthorized)`** — Same root cause: `","solution":"### Fix 1: `frontend/services/db.ts` — Auth headers + silent degradation\n- Import `getAuthHeaders()` from `auth.ts`\n- All fetch calls include auth headers when a token exists\n- Write operations (`insertSession`, `endSession`, `insertPromptLog`) skip entirely when no token is available (unauthenticated intro flow)\n- Wrap write operations in try/catch to suppress network errors\n\n### Fix 2: `frontend","criteria":["No 405 errors for `/api/sessions` during unauthenticated flows","No 401 errors for `/api/prompt-logs` during unauthenticated flows","TTS routes through backend; no \"API key not configured\" errors","Browser speechSynthesis fallback still works when backend TTS fails","Logged-in users still get session/prompt-log tracking"],"deps":"- Backend `/api/v1/ai/tts` endpoint (already exists)\n- Backend `/api/sessions` route registration (requires `deps.Session != nil` — 405 may indicate the Session handler is not initialized in local dev)","notes":"- The `ajaxRequestInterceptor.ps.js` in stack traces is a browser extension interceptor, not our code.\n- `SES Removing unpermitted intrinsics` is from a MetaMask-style browser extension (Secure EcmaScript), not our app."},{"id":"FR-118","title":"Chat Playback Controls (Play/Pause + Volume)","status":"done","priority":"should","problem":"Every assistant message shows a small speaker icon that fires TTS, but there is no way to pause, resume, or control volume. Clicking the speaker always starts from the beginning and there is no stop button. Users need proper audio controls.","solution":"Add play/pause toggle and volume slider to every assistant chat bubble:\n- **Play/Pause toggle** — start reading, pause mid-playback, resume from paused position\n- **Speaker icon with volume slider** — popup range slider (0-1), persisted in localStorage\n\n### Components Changed\n- `frontend/types/speech.ts` — new `SpeechControls` interface\n- `frontend/hooks/useSpeechSynthesis.ts` — added `isPaused`, ","criteria":["Assistant bubbles show play and speaker buttons; user bubbles show nothing","Click play starts TTS; shows spinner while loading, pause icon while playing","Click pause pauses audio; click play resumes from paused position","Speaker icon opens volume slider popup","Volume changes apply immediately and persist across reload (localStorage key `skillr-tts-volume`)","Playing a different bubble stops the current one","Minimum 44px touch targets on all controls","German tooltips on all buttons"],"deps":"- Uses existing backend TTS endpoint (unchanged)\n- Requires `pcmToWavBlob` from `services/audioUtils`","notes":"- `AudioModeStation.tsx` is unaffected (custom UI, no ChatBubble)\n- `ChatInput.tsx` is unaffected (speech input, not output)"},{"id":"FR-119","title":"Partner Preview Page","status":"specified","priority":"must","problem":"Partners who sponsor content packs (per BC-007 Bildungssponsoring) need a visible, public-facing page to showcase their contribution to SkillR. Currently there is no partner-facing preview that shows branding, sponsored Lernreisen, and a call-to-action.","solution":"A URL-parameter-driven partner preview page accessible via `?partner=slug`. The page renders outside the main app Layout (like WelcomePage) and shows:\n\n1. **Hero** — gradient using partner theme colors, partner name, tagline, \"SkillR Bildungspartner\" badge\n2. **Partner info** — company description, key facts (for SSI: 152 Ausstellungen, 100K+ Objekte, 20M+ Besucher, Silberner Meridian 2024)\n3. **L","criteria":["`?partner=space-service-intl` renders full preview page with navy/cyan SSI theme","3 Lernreise cards displayed: Kosmonautentraining, Gagarins Spuren, Mission Mars","\"Reise starten\" redirects to main app with SSI branding active","`?partner=nonexistent` shows \"Partner nicht gefunden\" state","Page works without backend via hardcoded SSI fallback","Mobile-responsive layout"],"deps":"- FR-116: Lernreise Content Pack (pack infrastructure)\n- FR-086*: Partner Branding (brand system)\n- BC-007: Bildungssponsoring","notes":"- Space Service International (Mittweida) is the first example partner\n- Starfield decoration in hero section creates cosmic atmosphere for SSI"},{"id":"FR-120","title":"Partner Content Pack Admin","status":"specified","priority":"should","problem":"Partners and SkillR admins need an interface to manage partner-specific content packs, brand configuration, and preview links. Currently, brand config can only be managed through the general BrandConfigEditor, with no partner-scoped admin view.","solution":"A URL-parameter-driven admin page accessible via `?partner-admin=slug`. Requires admin role (checked in App.tsx before rendering). The page provides:\n\n1. **Brand Config panel** — edit brand name, short name, tagline, contact email, primary/accent colors\n2. **Content Pack panel** — shows packs linked to this partner with their Lernreisen list and activation status\n3. **Preview link** — generates `?","criteria":["`?partner-admin=space-service-intl` renders admin page when logged in as admin","Brand config fields are editable and saveable","Content pack 003 \"Abenteuer Weltraum\" shown with 3 Lernreisen","Preview URL copyable to clipboard","Non-admin users see \"Zugriff verweigert\" message","Unauthenticated users see \"Zugriff verweigert\" message"],"deps":"- FR-119: Partner Preview Page\n- FR-086*: Partner Branding (brand system)\n- FR-044: Role Management","notes":"- Uses `getAuthHeaders()` from `services/auth.ts` for authenticated API calls\n- Reuses Field component pattern from BrandConfigEditor"},{"id":"FR-121","title":"Space Service International Example Partner","status":"specified","priority":"must","problem":"The partner system needs a real-world example to validate the design and serve as a demo. Space Service International (SSI) in Mittweida, Germany is the first SkillR Bildungspartner with existing sponsored content (pack 003 \"Abenteuer Weltraum\", 3 Space Lernreisen).","solution":"Seed data, brand config, and hardcoded fallback constants for SSI:\n\n### Database (migration 000025)\n- `brand_configs` row: slug `space-service-intl`, navy/cyan theme, SSI legal info\n- `brand_content_packs` junction: links pack 003 to SSI brand\n\n### Frontend Constants\n- `SSI_BRAND: BrandConfig` — full brand config with `#1e3a5f` primary / `#4fc3f7` accent\n- `SSI_PARTNER_DESCRIPTION` — museum facts:","criteria":["SSI brand seeded in `brand_configs` via migration 000025","Pack 003 linked to SSI in `brand_content_packs`","Frontend fallback returns 3 Lernreisen for `space-service-intl`","`?partner=space-service-intl` renders navy/cyan themed preview","API endpoint returns SSI data when DB is available"],"deps":"- FR-119: Partner Preview Page\n- FR-116: Lernreise Content Pack\n- Migration 000024: content_packs_meta (pack 003 seed)\n- Migration 000025: brand_content_packs (SSI brand + link)","notes":"- SSI serves as the template for future partner onboarding\n- Hardcoded fallback ensures the demo works even without a running backend"},{"id":"FR-122","title":"Brand List — Partner Page Link","status":"in-progress","priority":"should","problem":"In the admin Brand list view, each partner row shows only \"Bearbeiten\" and \"Deaktivieren\" actions. There is no quick way to preview the partner's public-facing page (`?partner=slug`) from the admin panel.","solution":"Add a \"Partner-Seite\" link to each brand row in the BrandConfigEditor list view. The link opens the partner preview page (`?partner=<slug>`) in a new tab.","criteria":["Each brand row shows a \"Partner-Seite\" link between the brand info and the edit/deactivate actions","Link opens `?partner=<slug>` in a new browser tab (`target=\"_blank\"`)","Link is only shown for active brands (inactive brands have no public page)","Visual style matches existing action links (text-xs, subtle color)"],"deps":"- FR-119: Partner Preview Page (provides the `?partner=slug` route)","notes":"- Uses an external-link icon to signal \"opens in new tab\""},{"id":"FR-123","title":"Hard-coded Brand Onboarding","status":"in-progress","priority":"must","problem":"New partners go through a two-phase lifecycle: first they're prototyped as hardcoded frontend constants (for rapid iteration and offline fallback), then they need to be persisted to the database so their brand config, content packs, Lernreisen, and brand-pack links are available to the full platform. This manual re-creation is tedious, error-prone, and means content packs are missing until the DB ","solution":"### Phase 1: Hardcoded Constants (Frontend)\n\nEach partner is defined as a set of frontend constants in `frontend/constants/partners/`:\n\n| Export | Purpose |\n|--------|---------|\n| `*_BRAND: BrandConfig` | Full brand config for offline fallback |\n| `*_SUMMARY: PartnerSummary` | Lightweight card data for partner listings |\n| `*_LERNREISE_IDS: string[]` | Associated Lernreise IDs |\n| `*_PARTNER_DESCR","criteria":["Admin panel shows all hardcoded partners even if not in DB","\"Nur lokal\" badge visible on brands not yet in database","Clicking \"Bearbeiten\" on a local brand opens pre-filled form with locked slug","Form shows \"In Datenbank speichern\" button (not \"Brand erstellen\")","After saving, list refreshes and \"Nur lokal\" badge is gone","Hardcoded constants remain as offline fallback regardless of DB state","Partner cards on WelcomePage/LandingPage merge API + hardcoded data","Content packs seeded in migration with Lernreisen and brand-pack links","Partner preview pages work for all 3 partners (with and without backend)","`lernreisenCount` badge shows correct count on partner cards"],"deps":"- FR-119: Partner preview page\n- FR-120: Partner content pack admin"},{"id":"FR-124","title":"Content Pack Editor","status":"in-progress","priority":"must","problem":"Content packs and their Lernreisen can currently only be created via SQL migrations. The admin UI (BrandConfigEditor) only supports toggling pack activation per brand — there is no way to create, edit, or manage packs or Lernreisen through the interface. This forces every content change through a developer, blocking partner onboarding velocity.","solution":"Add a \"Content Packs\" tab to the Management Console with full CRUD for packs and their Lernreisen. This is the **admin-facing** foundation that FR-080 (Lernreise Editor) will later build on for sponsor-facing tiers.\n\n### Pack CRUD\n- List all content packs with Lernreise count\n- Create new content pack (id, name, description, sponsor, default_enabled)\n- Edit existing pack metadata\n- Delete pack (CA","criteria":["\"Content Packs\" tab visible in Management Console for admin users","Admin can create, edit, and delete content packs","Admin can add, edit, remove, and reorder Lernreisen within a pack","Pack deletion cascades to lernreisen and brand_content_packs links","Lernreise card preview updates live while editing","Validation prevents invalid data (missing required fields, invalid IDs, out-of-range coordinates)","All CRUD operations require admin authentication","Changes are immediately reflected in the public content pack API"],"deps":"- FR-116 (Content Pack) — data model and read API\n- FR-119 (Partner Preview Page) — brand-pack junction table\n- FR-120 (Partner Content Pack Admin) — brand-scoped read-only view\n- FR-123 (Hard-coded Brand Onboarding) — migration-based seeding (replaced by this FR)","notes":"- FR-080 (Lernreise Editor) is the future sponsor-facing editor (Professional/Enterprise tier). FR-124 is the admin-facing foundation.\n- Migration 000027 adds ON DELETE CASCADE to content_pack_lernreisen.pack_id and brand_content_packs.pack_id foreign keys."},{"id":"FR-125","title":"Lernreise Editor — Geo-Lookup for Station Locations","status":"open","priority":"could","entity":"SkillR","gate":"MVP4","problem":"When editing a Lernreise station, the admin must manually enter latitude and longitude for the station location. This is error-prone (coordinates default to 0/0) and requires the admin to look up coordinates externally.","solution":"Add a geocoding search to the station location section of the Lernreise editor. The admin types a search query (e.g. \"06217 Frankleben DE\") and picks from matching results in a modal. The selected result auto-fills the Location, Breitengrad (lat), and Laengengrad (lng) fields.\n\n### Search Input\n- A single text field accepting `ZIP City (Country)` queries, e.g. `06217 Frankleben DE`\n- A \"Suchen\" bu","criteria":["Location section in Lernreise editor has a search field with \"Suchen\" button","Clicking \"Suchen\" queries Nominatim with the entered text","Results modal shows matching locations with display name and coordinates","Selecting a result fills Location, lat, lng fields automatically","Manual coordinate entry still works as before","Empty/failed search shows appropriate feedback"],"deps":"- FR-124 (Content Pack Editor) — the Lernreise editor where this is integrated\n- OBS-001 (Gemini Quota) — GCP billing must be active (same prerequisite)","notes":"- Uses **Google Geocoding API** via GCP: `https://maps.googleapis.com/maps/api/geocode/json?address=...&key=API_KEY`\n- Requires `geocoding` or `places` API enabled in GCP project\n- API key should be restricted to Geocoding API and referrer-locked to the admin domain\n- Geocoding calls should be proxi"}];

const PHASES = [
  {
    id: 'v1.0',
    title: 'SkillR V1.0',
    codename: '"Erste Reise"',
    badge: 'next',
    goal: 'Production-ready SkillR app for IHK pilot. DSGVO-compliant, role-based views, parent dashboard. Ready for 100+ users.',
    frs: ['DFR-001','DFR-002','DFR-003','DFR-004','DFR-005','DFR-006','DFR-007','DFR-008','FR-001','FR-002','FR-003','FR-004','FR-005','FR-006','FR-007','FR-008','FR-009','FR-010','FR-011','FR-012','FR-013','FR-014','FR-020','FR-021','FR-022','FR-023','FR-025','FR-026','FR-027','FR-028','FR-029','FR-031','FR-032','FR-033','FR-038','FR-039','FR-040','FR-041','FR-042','FR-043','FR-044','FR-045','FR-046','FR-047','FR-048','FR-049','FR-050','FR-051','FR-052','FR-054','FR-055','FR-056','FR-057','FR-058','FR-059','FR-060','FR-061','FR-062','FR-063','FR-064','FR-065','FR-066','FR-067','FR-068','FR-069','FR-070','FR-071','FR-072','FR-073','FR-074','FR-075','FR-076','FR-077','FR-078','FR-083','FR-084','FR-085','FR-086'],
    exit: [
      {t:'DSGVO-compliant: parental consent flow for under-16', s:'pending'},
      {t:'Role-specific views: student, parent, admin', s:'pending'},
      {t:'Parents can see child\'s progress (privacy-respecting)', s:'pending'},
      {t:'All in-progress FRs completed', s:'pending'},
      {t:'100 concurrent users without degradation', s:'pending'},
      {t:'Deployed to SkillR GCP project', s:'pending'},
      {t:'Health monitoring active', s:'done'},
      {t:'All CORE tests passing', s:'partial'}
    ]
  },
  {
    id: 'v1.1',
    title: 'SkillR V1.1',
    codename: '"Mehr entdecken"',
    badge: 'planned',
    goal: 'Enhanced experience. Toggle on SELECT features that improve the user journey. Wikipedia grounding, Job-Navigator, multi-agent coaching, theme system.',
    frs: ['FR-015','FR-016','FR-017','FR-018','FR-019','FR-024','FR-030','FR-034','FR-053'],
    exit: [
      {t:'At least 3 SELECT features promoted and shipped', s:'pending'},
      {t:'Job-Navigator shows real German job data', s:'pending'},
      {t:'All promoted features have unit + integration tests', s:'pending'},
      {t:'User engagement metrics improve over V1.0 baseline', s:'pending'}
    ]
  },
  {
    id: 'v2.0',
    title: 'SkillR V2.0',
    codename: '"Partner & Sponsoren"',
    badge: 'future',
    goal: 'B2B sponsor integration. Companies sponsor skills and learning journeys. Branded micro-sites, Stripe payments, sponsor analytics. Revenue through Bildungssponsoring.',
    frs: ['FR-035','FR-036','FR-037','FR-079','FR-080','FR-081','FR-082'],
    exit: [
      {t:'{slug}.maindset.academy renders sponsor\'s branded showroom', s:'pending'},
      {t:'Sponsor can self-onboard in <15 minutes', s:'pending'},
      {t:'Stripe trial-to-paid conversion works end-to-end', s:'pending'},
      {t:'Analytics show aggregate showroom traffic', s:'pending'},
      {t:'All sponsor-facing text is in German', s:'pending'},
      {t:'Platform API published with partner API key authentication', s:'pending'},
      {t:'Tenant isolation verified: no user data leaks between clients', s:'pending'}
    ]
  },
  {
    id: 'backlog',
    title: 'Backlog / Ops',
    codename: '"Warteschlange"',
    badge: 'future',
    goal: 'Operational and infrastructure FRs not yet assigned to a release phase. Includes ops tooling, CI/CD, monitoring, and future explorations.',
    frs: ['FR-087','FR-088','FR-089','FR-090','FR-091','FR-092','FR-093','FR-094','FR-095','FR-096','FR-111','FR-112','FR-113','FR-114','FR-115','FR-116','FR-117','FR-118','FR-119','FR-120','FR-121','FR-122','FR-123','FR-124','FR-125'],
    exit: []
  }
];

// Index FR data
const frMap = {};
FR_DATA.forEach(fr => frMap[fr.id] = fr);

// Compute stats
const stats = { done: 0, progress: 0, draft: 0, specified: 0 };
FR_DATA.forEach(fr => {
  if (fr.status === 'done') stats.done++;
  else if (fr.status === 'in-progress') stats.progress++;
  else if (fr.status === 'specified') stats.specified++;
  else stats.draft++;
});
document.getElementById('stat-done').textContent = stats.done;
document.getElementById('stat-progress').textContent = stats.progress;
document.getElementById('stat-draft').textContent = stats.draft;
document.getElementById('stat-specified').textContent = stats.specified;
document.getElementById('stat-total').textContent = FR_DATA.length;

// Current filter state
let currentFilter = 'all';
let currentSearch = '';

function matchesFilter(fr) {
  if (currentSearch) {
    const q = currentSearch.toLowerCase();
    if (!fr.id.toLowerCase().includes(q) && !fr.title.toLowerCase().includes(q)) return false;
  }
  if (currentFilter === 'all') return true;
  if (currentFilter === 'must') return fr.priority === 'must';
  return fr.status === currentFilter;
}

function renderPhases() {
  const container = document.getElementById('phases');
  container.innerHTML = '';

  PHASES.forEach((phase, pi) => {
    const frs = phase.frs.map(id => frMap[id]).filter(Boolean);
    const visibleFrs = frs.filter(matchesFilter);
    const doneFrs = frs.filter(f => f.status === 'done').length;
    const pct = frs.length ? Math.round(doneFrs / frs.length * 100) : 0;

    const div = document.createElement('div');
    div.className = 'phase' + (pi === 0 ? ' open' : '');

    div.innerHTML = `
      <div class="phase-head" onclick="this.parentElement.classList.toggle('open')">
        <div class="phase-left">
          <h2>${phase.title}</h2>
          <span class="codename">${phase.codename}</span>
        </div>
        <div class="phase-right">
          <span class="badge badge-${phase.badge}">${phase.badge === 'next' ? 'Next Up' : phase.badge === 'complete' ? 'Complete' : phase.badge === 'planned' ? 'Planned' : 'Future'}</span>
          <span style="font-size:0.8rem;color:var(--muted)">${doneFrs}/${frs.length}</span>
          <span class="chevron">&#9656;</span>
        </div>
      </div>
      <div class="phase-body">
        <div class="phase-goal">${phase.goal}</div>
        <div class="prog-wrap">
          <div class="prog-info"><span>${doneFrs} of ${frs.length} FRs done</span><span>${pct}%</span></div>
          <div class="prog-bar"><div class="prog-fill ${pct === 100 ? 'green' : 'blue'}" style="width:${pct}%"></div></div>
        </div>
        <div class="fr-grid" id="grid-${phase.id}"></div>
        ${phase.exit.length ? `
        <div class="exit-block">
          <h4>Exit Criteria</h4>
          <ul class="exit-list">
            ${phase.exit.map(e => `<li class="${e.s}">${e.t}</li>`).join('')}
          </ul>
        </div>` : ''}
      </div>
    `;
    container.appendChild(div);

    // Render FR cards
    const grid = div.querySelector('.fr-grid');
    visibleFrs.forEach(fr => {
      const card = document.createElement('div');
      card.className = 'fr-card';
      card.onclick = () => openModal(fr.id);
      card.innerHTML = `
        <div class="fr-card-top">
          <span class="fr-id">${fr.id}</span>
          <span class="fr-title">${fr.title}</span>
        </div>
        <div class="fr-card-bottom">
          <span class="fr-tag ${fr.status}">${fr.status}</span>
          <span class="fr-tag ${fr.priority}">${fr.priority}</span>
          ${fr.entity ? `<span class="fr-tag entity">${fr.entity}</span>` : ''}
        </div>
      `;
      grid.appendChild(card);
    });

    if (visibleFrs.length === 0 && frs.length > 0) {
      grid.innerHTML = '<div style="color:var(--muted);font-size:0.82rem;padding:0.5rem">No matching FRs in this phase</div>';
    }
  });
}

// Modal
function openModal(id) {
  const fr = frMap[id];
  if (!fr) return;

  document.getElementById('modal-id').textContent = fr.id;
  document.getElementById('modal-title').textContent = fr.title;

  const meta = document.getElementById('modal-meta');
  meta.innerHTML = `
    <span class="fr-tag ${fr.status}" style="font-size:0.75rem">${fr.status}</span>
    <span class="fr-tag ${fr.priority}" style="font-size:0.75rem">${fr.priority}</span>
    ${fr.entity ? `<span class="fr-tag entity" style="font-size:0.75rem;max-width:none">${fr.entity}</span>` : ''}
  `;

  const body = document.getElementById('modal-body');
  let html = '';

  if (fr.problem) {
    html += `<div class="modal-section"><h4>Problem</h4><p>${escHtml(fr.problem)}</p></div>`;
  }
  if (fr.solution) {
    html += `<div class="modal-section"><h4>Solution</h4><p>${escHtml(fr.solution)}</p></div>`;
  }
  if (fr.criteria && fr.criteria.length) {
    html += `<div class="modal-section"><h4>Acceptance Criteria</h4><ul>${fr.criteria.map(c => `<li>${escHtml(c)}</li>`).join('')}</ul></div>`;
  }
  if (fr.deps) {
    html += `<div class="modal-section"><h4>Dependencies</h4><div class="deps">${escHtml(fr.deps)}</div></div>`;
  }
  if (fr.notes) {
    html += `<div class="modal-section"><h4>Notes</h4><p>${escHtml(fr.notes)}</p></div>`;
  }

  if (!html) {
    html = '<div class="modal-section"><p style="color:var(--muted)">No detailed content available for this FR.</p></div>';
  }

  body.innerHTML = html;
  document.getElementById('modal-overlay').classList.add('visible');
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  document.getElementById('modal-overlay').classList.remove('visible');
  document.body.style.overflow = '';
}

function escHtml(s) {
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');
}

document.getElementById('modal-close').onclick = closeModal;
document.getElementById('modal-overlay').onclick = function(e) {
  if (e.target === this) closeModal();
};
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

// Filters
document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentFilter = btn.dataset.filter;
    renderPhases();
  };
});

document.getElementById('search').oninput = function() {
  currentSearch = this.value;
  renderPhases();
};

// Initial render
renderPhases();

</script>
</html>